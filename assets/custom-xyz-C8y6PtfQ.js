import{b as pi,u as mi,E as vi}from"./index-XVBT3eyP.js";import{p as ea,_ as ha,o as Yt,c as ua,f as it,a as St,d as ut,w as Vt,q as yi,s as di,ao as gi,al as xi}from"./app-BIv4BGsj.js";import{E as bi}from"./index-C2AhXWuI.js";import{E as Ei}from"./index-D34mQpmt.js";import{E as Oi}from"./index-CMV7vHea.js";var Et={exports:{}};Et.exports=Ot,Et.exports.default=Ot;function Ot(t,a,i){i=i||2;var n=a&&a.length,o=n?a[0]*i:t.length,s=ca(t,0,o,i,!0),e=[];if(!s||s.next===s.prev)return e;var h,u,c,l,M,r,f;if(n&&(s=Pi(t,a,s,i)),t.length>80*i){h=c=t[0],u=l=t[1];for(var p=i;p<o;p+=i)M=t[p],r=t[p+1],M<h&&(h=M),r<u&&(u=r),M>c&&(c=M),r>l&&(l=r);f=Math.max(c-h,l-u),f=f!==0?32767/f:0}return st(s,e,i,h,u,f,0),e}function ca(t,a,i,n,o){var s,e;if(o===zt(t,a,i,n)>0)for(s=a;s<i;s+=n)e=Ut(s,t[s],t[s+1],e);else for(s=i-n;s>=a;s-=n)e=Ut(s,t[s],t[s+1],e);return e&&Pt(e,e.next)&&(ht(e),e=e.next),e}function H(t,a){if(!t)return t;a||(a=t);var i=t,n;do if(n=!1,!i.steiner&&(Pt(i,i.next)||z(i.prev,i,i.next)===0)){if(ht(i),i=a=i.prev,i===i.next)break;n=!0}else i=i.next;while(n||i!==a);return a}function st(t,a,i,n,o,s,e){if(t){!e&&s&&Ni(t,n,o,s);for(var h=t,u,c;t.prev!==t.next;){if(u=t.prev,c=t.next,s?Ti(t,n,o,s):_i(t)){a.push(u.i/i|0),a.push(t.i/i|0),a.push(c.i/i|0),ht(t),t=c.next,h=c.next;continue}if(t=c,t===h){e?e===1?(t=Ai(H(t),a,i),st(t,a,i,n,o,s,2)):e===2&&Ri(t,a,i,n,o,s):st(H(t),a,i,n,o,s,1);break}}}}function _i(t){var a=t.prev,i=t,n=t.next;if(z(a,i,n)>=0)return!1;for(var o=a.x,s=i.x,e=n.x,h=a.y,u=i.y,c=n.y,l=o<s?o<e?o:e:s<e?s:e,M=h<u?h<c?h:c:u<c?u:c,r=o>s?o>e?o:e:s>e?s:e,f=h>u?h>c?h:c:u>c?u:c,p=n.next;p!==a;){if(p.x>=l&&p.x<=r&&p.y>=M&&p.y<=f&&Q(o,h,s,u,e,c,p.x,p.y)&&z(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function Ti(t,a,i,n){var o=t.prev,s=t,e=t.next;if(z(o,s,e)>=0)return!1;for(var h=o.x,u=s.x,c=e.x,l=o.y,M=s.y,r=e.y,f=h<u?h<c?h:c:u<c?u:c,p=l<M?l<r?l:r:M<r?M:r,v=h>u?h>c?h:c:u>c?u:c,m=l>M?l>r?l:r:M>r?M:r,d=Dt(f,p,a,i,n),O=Dt(v,m,a,i,n),y=t.prevZ,g=t.nextZ;y&&y.z>=d&&g&&g.z<=O;){if(y.x>=f&&y.x<=v&&y.y>=p&&y.y<=m&&y!==o&&y!==e&&Q(h,l,u,M,c,r,y.x,y.y)&&z(y.prev,y,y.next)>=0||(y=y.prevZ,g.x>=f&&g.x<=v&&g.y>=p&&g.y<=m&&g!==o&&g!==e&&Q(h,l,u,M,c,r,g.x,g.y)&&z(g.prev,g,g.next)>=0))return!1;g=g.nextZ}for(;y&&y.z>=d;){if(y.x>=f&&y.x<=v&&y.y>=p&&y.y<=m&&y!==o&&y!==e&&Q(h,l,u,M,c,r,y.x,y.y)&&z(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;g&&g.z<=O;){if(g.x>=f&&g.x<=v&&g.y>=p&&g.y<=m&&g!==o&&g!==e&&Q(h,l,u,M,c,r,g.x,g.y)&&z(g.prev,g,g.next)>=0)return!1;g=g.nextZ}return!0}function Ai(t,a,i){var n=t;do{var o=n.prev,s=n.next.next;!Pt(o,s)&&la(o,n,n.next,s)&&et(o,s)&&et(s,o)&&(a.push(o.i/i|0),a.push(n.i/i|0),a.push(s.i/i|0),ht(n),ht(n.next),n=t=s),n=n.next}while(n!==t);return H(n)}function Ri(t,a,i,n,o,s){var e=t;do{for(var h=e.next.next;h!==e.prev;){if(e.i!==h.i&&Yi(e,h)){var u=ra(e,h);e=H(e,e.next),u=H(u,u.next),st(e,a,i,n,o,s,0),st(u,a,i,n,o,s,0);return}h=h.next}e=e.next}while(e!==t)}function Pi(t,a,i,n){var o=[],s,e,h,u,c;for(s=0,e=a.length;s<e;s++)h=a[s]*n,u=s<e-1?a[s+1]*n:t.length,c=ca(t,h,u,n,!1),c===c.next&&(c.steiner=!0),o.push(Ii(c));for(o.sort(Li),s=0;s<o.length;s++)i=Si(o[s],i);return i}function Li(t,a){return t.x-a.x}function Si(t,a){var i=Ci(t,a);if(!i)return a;var n=ra(i,t);return H(n,n.next),H(i,i.next)}function Ci(t,a){var i=a,n=t.x,o=t.y,s=-1/0,e;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var h=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(h<=n&&h>s&&(s=h,e=i.x<i.next.x?i:i.next,h===n))return e}i=i.next}while(i!==a);if(!e)return null;var u=e,c=e.x,l=e.y,M=1/0,r;i=e;do n>=i.x&&i.x>=c&&n!==i.x&&Q(o<l?n:s,o,c,l,o<l?s:n,o,i.x,i.y)&&(r=Math.abs(o-i.y)/(n-i.x),et(i,t)&&(r<M||r===M&&(i.x>e.x||i.x===e.x&&wi(e,i)))&&(e=i,M=r)),i=i.next;while(i!==u);return e}function wi(t,a){return z(t.prev,t,a.prev)<0&&z(a.next,t,t.next)<0}function Ni(t,a,i,n){var o=t;do o.z===0&&(o.z=Dt(o.x,o.y,a,i,n)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next;while(o!==t);o.prevZ.nextZ=null,o.prevZ=null,ki(o)}function ki(t){var a,i,n,o,s,e,h,u,c=1;do{for(i=t,t=null,s=null,e=0;i;){for(e++,n=i,h=0,a=0;a<c&&(h++,n=n.nextZ,!!n);a++);for(u=c;h>0||u>0&&n;)h!==0&&(u===0||!n||i.z<=n.z)?(o=i,i=i.nextZ,h--):(o=n,n=n.nextZ,u--),s?s.nextZ=o:t=o,o.prevZ=s,s=o;i=n}s.nextZ=null,c*=2}while(e>1);return t}function Dt(t,a,i,n,o){return t=(t-i)*o|0,a=(a-n)*o|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,a=(a|a<<8)&16711935,a=(a|a<<4)&252645135,a=(a|a<<2)&858993459,a=(a|a<<1)&1431655765,t|a<<1}function Ii(t){var a=t,i=t;do(a.x<i.x||a.x===i.x&&a.y<i.y)&&(i=a),a=a.next;while(a!==t);return i}function Q(t,a,i,n,o,s,e,h){return(o-e)*(a-h)>=(t-e)*(s-h)&&(t-e)*(n-h)>=(i-e)*(a-h)&&(i-e)*(s-h)>=(o-e)*(n-h)}function Yi(t,a){return t.next.i!==a.i&&t.prev.i!==a.i&&!Di(t,a)&&(et(t,a)&&et(a,t)&&Fi(t,a)&&(z(t.prev,t,a.prev)||z(t,a.prev,a))||Pt(t,a)&&z(t.prev,t,t.next)>0&&z(a.prev,a,a.next)>0)}function z(t,a,i){return(a.y-t.y)*(i.x-a.x)-(a.x-t.x)*(i.y-a.y)}function Pt(t,a){return t.x===a.x&&t.y===a.y}function la(t,a,i,n){var o=lt(z(t,a,i)),s=lt(z(t,a,n)),e=lt(z(i,n,t)),h=lt(z(i,n,a));return!!(o!==s&&e!==h||o===0&&ct(t,i,a)||s===0&&ct(t,n,a)||e===0&&ct(i,t,n)||h===0&&ct(i,a,n))}function ct(t,a,i){return a.x<=Math.max(t.x,i.x)&&a.x>=Math.min(t.x,i.x)&&a.y<=Math.max(t.y,i.y)&&a.y>=Math.min(t.y,i.y)}function lt(t){return t>0?1:t<0?-1:0}function Di(t,a){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==a.i&&i.next.i!==a.i&&la(i,i.next,t,a))return!0;i=i.next}while(i!==t);return!1}function et(t,a){return z(t.prev,t,t.next)<0?z(t,a,t.next)>=0&&z(t,t.prev,a)>=0:z(t,a,t.prev)<0||z(t,t.next,a)<0}function Fi(t,a){var i=t,n=!1,o=(t.x+a.x)/2,s=(t.y+a.y)/2;do i.y>s!=i.next.y>s&&i.next.y!==i.y&&o<(i.next.x-i.x)*(s-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next;while(i!==t);return n}function ra(t,a){var i=new Ft(t.i,t.x,t.y),n=new Ft(a.i,a.x,a.y),o=t.next,s=a.prev;return t.next=a,a.prev=t,i.next=o,o.prev=i,n.next=i,i.prev=n,s.next=n,n.prev=s,n}function Ut(t,a,i,n){var o=new Ft(t,a,i);return n?(o.next=n.next,o.prev=n,n.next.prev=o,n.next=o):(o.prev=o,o.next=o),o}function ht(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Ft(t,a,i){this.i=t,this.x=a,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Ot.deviation=function(t,a,i,n){var o=a&&a.length,s=o?a[0]*i:t.length,e=Math.abs(zt(t,0,s,i));if(o)for(var h=0,u=a.length;h<u;h++){var c=a[h]*i,l=h<u-1?a[h+1]*i:t.length;e-=Math.abs(zt(t,c,l,i))}var M=0;for(h=0;h<n.length;h+=3){var r=n[h]*i,f=n[h+1]*i,p=n[h+2]*i;M+=Math.abs((t[r]-t[p])*(t[f+1]-t[r+1])-(t[r]-t[f])*(t[p+1]-t[r+1]))}return e===0&&M===0?0:Math.abs((M-e)/e)};function zt(t,a,i,n){for(var o=0,s=a,e=i-n;s<i;s+=n)o+=(t[e]-t[s])*(t[s+1]+t[e+1]),e=s;return o}Ot.flatten=function(t){for(var a=t[0][0].length,i={vertices:[],holes:[],dimensions:a},n=0,o=0;o<t.length;o++){for(var s=0;s<t[o].length;s++)for(var e=0;e<a;e++)i.vertices.push(t[o][s][e]);o>0&&(n+=t[o-1].length,i.holes.push(n))}return i};const K={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function zi(t,{precision:a=K.precision}={}){return t=ji(t),"".concat(parseFloat(t.toPrecision(a)))}function jt(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function fa(t,a,i){const n=K.EPSILON;try{if(t===a)return!0;if(jt(t)&&jt(a)){if(t.length!==a.length)return!1;for(let o=0;o<t.length;++o)if(!fa(t[o],a[o]))return!1;return!0}return t&&t.equals?t.equals(a):a&&a.equals?a.equals(t):typeof t=="number"&&typeof a=="number"?Math.abs(t-a)<=K.EPSILON*Math.max(1,Math.abs(t),Math.abs(a)):!1}finally{K.EPSILON=n}}function ji(t){return Math.round(t/K.EPSILON)*K.EPSILON}function qi(t){function a(){var i=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(i,Object.getPrototypeOf(this)),i}return a.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(a,t):a.__proto__=t,a}class Wi extends qi(Array){clone(){return new this.constructor().copy(this)}fromArray(a,i=0){for(let n=0;n<this.ELEMENTS;++n)this[n]=a[n+i];return this.check()}toArray(a=[],i=0){for(let n=0;n<this.ELEMENTS;++n)a[i+n]=this[n];return a}from(a){return Array.isArray(a)?this.copy(a):this.fromObject(a)}to(a){return a===this?this:jt(a)?this.toArray(a):this.toObject(a)}toTarget(a){return a?this.to(a):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(K)}formatString(a){let i="";for(let n=0;n<this.ELEMENTS;++n)i+=(n>0?", ":"")+zi(this[n],a);return"".concat(a.printTypes?this.constructor.name:"","[").concat(i,"]")}equals(a){if(!a||this.length!==a.length)return!1;for(let i=0;i<this.ELEMENTS;++i)if(!fa(this[i],a[i]))return!1;return!0}exactEquals(a){if(!a||this.length!==a.length)return!1;for(let i=0;i<this.ELEMENTS;++i)if(this[i]!==a[i])return!1;return!0}negate(){for(let a=0;a<this.ELEMENTS;++a)this[a]=-this[a];return this.check()}lerp(a,i,n){if(n===void 0)return this.lerp(this,a,i);for(let o=0;o<this.ELEMENTS;++o){const s=a[o];this[o]=s+n*(i[o]-s)}return this.check()}min(a){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(a[i],this[i]);return this.check()}max(a){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.max(a[i],this[i]);return this.check()}clamp(a,i){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],a[n]),i[n]);return this.check()}add(...a){for(const i of a)for(let n=0;n<this.ELEMENTS;++n)this[n]+=i[n];return this.check()}subtract(...a){for(const i of a)for(let n=0;n<this.ELEMENTS;++n)this[n]-=i[n];return this.check()}scale(a){if(typeof a=="number")for(let i=0;i<this.ELEMENTS;++i)this[i]*=a;else for(let i=0;i<this.ELEMENTS&&i<a.length;++i)this[i]*=a[i];return this.check()}multiplyByScalar(a){for(let i=0;i<this.ELEMENTS;++i)this[i]*=a;return this.check()}check(){if(K.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let a=this.length===this.ELEMENTS;for(let i=0;i<this.ELEMENTS;++i)a=a&&Number.isFinite(this[i]);return a}sub(a){return this.subtract(a)}setScalar(a){for(let i=0;i<this.ELEMENTS;++i)this[i]=a;return this.check()}addScalar(a){for(let i=0;i<this.ELEMENTS;++i)this[i]+=a;return this.check()}subScalar(a){return this.addScalar(-a)}multiplyScalar(a){for(let i=0;i<this.ELEMENTS;++i)this[i]*=a;return this.check()}divideScalar(a){return this.multiplyByScalar(1/a)}clampScalar(a,i){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],a),i);return this.check()}get elements(){return this}}function Bi(t,a){if(t.length!==a)return!1;for(let i=0;i<t.length;++i)if(!Number.isFinite(t[i]))return!1;return!0}function Zi(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function Ct(t,a,i=""){if(K.debug&&!Bi(t,a))throw new Error("math.gl: ".concat(i," some fields set to invalid numbers'"));return t}var _={},j={};Object.defineProperty(j,"__esModule",{value:!0}),j.setMatrixArrayType=Ki,j.toRadian=Ui,j.equals=Gi,j.RANDOM=j.ARRAY_TYPE=j.EPSILON=void 0;var Ma=1e-6;j.EPSILON=Ma;var pa=typeof Float32Array<"u"?Float32Array:Array;j.ARRAY_TYPE=pa;var Xi=Math.random;j.RANDOM=Xi;function Ki(t){j.ARRAY_TYPE=pa=t}var Vi=Math.PI/180;function Ui(t){return t*Vi}function Gi(t,a){return Math.abs(t-a)<=Ma*Math.max(1,Math.abs(t),Math.abs(a))}Math.hypot||(Math.hypot=function(){for(var t=0,a=arguments.length;a--;)t+=arguments[a]*arguments[a];return Math.sqrt(t)});function pt(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?pt=function(a){return typeof a}:pt=function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},pt(t)}Object.defineProperty(_,"__esModule",{value:!0}),_.create=va,_.clone=Ji,_.fromValues=Qi,_.copy=tn,_.set=an,_.add=nn,_.subtract=ya,_.multiply=da,_.divide=ga,_.ceil=on,_.floor=sn,_.min=en,_.max=hn,_.round=un,_.scale=cn,_.scaleAndAdd=ln,_.distance=xa,_.squaredDistance=ba,_.length=Ea,_.squaredLength=Oa,_.negate=rn,_.inverse=fn,_.normalize=Mn,_.dot=pn,_.cross=mn,_.lerp=vn,_.random=yn,_.transformMat2=dn,_.transformMat2d=gn,_.transformMat3=xn;var $i=_.transformMat4=bn;_.rotate=En,_.angle=On,_.zero=_n,_.str=Tn,_.exactEquals=An,_.equals=Rn,_.forEach=_.sqrLen=_.sqrDist=_.dist=_.div=_.mul=_.sub=_.len=void 0;var J=Hi(j);function ma(t){if(typeof WeakMap!="function")return null;var a=new WeakMap,i=new WeakMap;return(ma=function(n){return n?i:a})(t)}function Hi(t,a){if(t&&t.__esModule)return t;if(t===null||pt(t)!=="object"&&typeof t!="function")return{default:t};var i=ma(a);if(i&&i.has(t))return i.get(t);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if(s!=="default"&&Object.prototype.hasOwnProperty.call(t,s)){var e=o?Object.getOwnPropertyDescriptor(t,s):null;e&&(e.get||e.set)?Object.defineProperty(n,s,e):n[s]=t[s]}return n.default=t,i&&i.set(t,n),n}function va(){var t=new J.ARRAY_TYPE(2);return J.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0),t}function Ji(t){var a=new J.ARRAY_TYPE(2);return a[0]=t[0],a[1]=t[1],a}function Qi(t,a){var i=new J.ARRAY_TYPE(2);return i[0]=t,i[1]=a,i}function tn(t,a){return t[0]=a[0],t[1]=a[1],t}function an(t,a,i){return t[0]=a,t[1]=i,t}function nn(t,a,i){return t[0]=a[0]+i[0],t[1]=a[1]+i[1],t}function ya(t,a,i){return t[0]=a[0]-i[0],t[1]=a[1]-i[1],t}function da(t,a,i){return t[0]=a[0]*i[0],t[1]=a[1]*i[1],t}function ga(t,a,i){return t[0]=a[0]/i[0],t[1]=a[1]/i[1],t}function on(t,a){return t[0]=Math.ceil(a[0]),t[1]=Math.ceil(a[1]),t}function sn(t,a){return t[0]=Math.floor(a[0]),t[1]=Math.floor(a[1]),t}function en(t,a,i){return t[0]=Math.min(a[0],i[0]),t[1]=Math.min(a[1],i[1]),t}function hn(t,a,i){return t[0]=Math.max(a[0],i[0]),t[1]=Math.max(a[1],i[1]),t}function un(t,a){return t[0]=Math.round(a[0]),t[1]=Math.round(a[1]),t}function cn(t,a,i){return t[0]=a[0]*i,t[1]=a[1]*i,t}function ln(t,a,i,n){return t[0]=a[0]+i[0]*n,t[1]=a[1]+i[1]*n,t}function xa(t,a){var i=a[0]-t[0],n=a[1]-t[1];return Math.hypot(i,n)}function ba(t,a){var i=a[0]-t[0],n=a[1]-t[1];return i*i+n*n}function Ea(t){var a=t[0],i=t[1];return Math.hypot(a,i)}function Oa(t){var a=t[0],i=t[1];return a*a+i*i}function rn(t,a){return t[0]=-a[0],t[1]=-a[1],t}function fn(t,a){return t[0]=1/a[0],t[1]=1/a[1],t}function Mn(t,a){var i=a[0],n=a[1],o=i*i+n*n;return o>0&&(o=1/Math.sqrt(o)),t[0]=a[0]*o,t[1]=a[1]*o,t}function pn(t,a){return t[0]*a[0]+t[1]*a[1]}function mn(t,a,i){var n=a[0]*i[1]-a[1]*i[0];return t[0]=t[1]=0,t[2]=n,t}function vn(t,a,i,n){var o=a[0],s=a[1];return t[0]=o+n*(i[0]-o),t[1]=s+n*(i[1]-s),t}function yn(t,a){a=a||1;var i=J.RANDOM()*2*Math.PI;return t[0]=Math.cos(i)*a,t[1]=Math.sin(i)*a,t}function dn(t,a,i){var n=a[0],o=a[1];return t[0]=i[0]*n+i[2]*o,t[1]=i[1]*n+i[3]*o,t}function gn(t,a,i){var n=a[0],o=a[1];return t[0]=i[0]*n+i[2]*o+i[4],t[1]=i[1]*n+i[3]*o+i[5],t}function xn(t,a,i){var n=a[0],o=a[1];return t[0]=i[0]*n+i[3]*o+i[6],t[1]=i[1]*n+i[4]*o+i[7],t}function bn(t,a,i){var n=a[0],o=a[1];return t[0]=i[0]*n+i[4]*o+i[12],t[1]=i[1]*n+i[5]*o+i[13],t}function En(t,a,i,n){var o=a[0]-i[0],s=a[1]-i[1],e=Math.sin(n),h=Math.cos(n);return t[0]=o*h-s*e+i[0],t[1]=o*e+s*h+i[1],t}function On(t,a){var i=t[0],n=t[1],o=a[0],s=a[1],e=Math.sqrt(i*i+n*n)*Math.sqrt(o*o+s*s),h=e&&(i*o+n*s)/e;return Math.acos(Math.min(Math.max(h,-1),1))}function _n(t){return t[0]=0,t[1]=0,t}function Tn(t){return"vec2("+t[0]+", "+t[1]+")"}function An(t,a){return t[0]===a[0]&&t[1]===a[1]}function Rn(t,a){var i=t[0],n=t[1],o=a[0],s=a[1];return Math.abs(i-o)<=J.EPSILON*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(n-s)<=J.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))}var Pn=Ea;_.len=Pn;var Ln=ya;_.sub=Ln;var Sn=da;_.mul=Sn;var Cn=ga;_.div=Cn;var wn=xa;_.dist=wn;var Nn=ba;_.sqrDist=Nn;var kn=Oa;_.sqrLen=kn;var In=function(){var t=va();return function(a,i,n,o,s,e){var h,u;for(i||(i=2),n||(n=0),o?u=Math.min(o*i+n,a.length):u=a.length,h=n;h<u;h+=i)t[0]=a[h],t[1]=a[h+1],s(t,t,e),a[h]=t[0],a[h+1]=t[1];return a}}();_.forEach=In;function Yn(t,a,i){const n=a[0],o=a[1],s=i[3]*n+i[7]*o||1;return t[0]=(i[0]*n+i[4]*o)/s,t[1]=(i[1]*n+i[5]*o)/s,t}function Dn(t,a,i){const n=a[0],o=a[1],s=a[2],e=i[3]*n+i[7]*o+i[11]*s||1;return t[0]=(i[0]*n+i[4]*o+i[8]*s)/e,t[1]=(i[1]*n+i[5]*o+i[9]*s)/e,t[2]=(i[2]*n+i[6]*o+i[10]*s)/e,t}var b={};function mt(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?mt=function(a){return typeof a}:mt=function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},mt(t)}Object.defineProperty(b,"__esModule",{value:!0}),b.create=Ta,b.clone=jn,b.length=Aa,b.fromValues=qn,b.copy=Wn,b.set=Bn,b.add=Zn,b.subtract=Ra,b.multiply=Pa,b.divide=La,b.ceil=Xn,b.floor=Kn,b.min=Vn,b.max=Un,b.round=Gn,b.scale=$n,b.scaleAndAdd=Hn,b.distance=Sa,b.squaredDistance=Ca,b.squaredLength=wa,b.negate=Jn,b.inverse=Qn,b.normalize=to,b.dot=Na,b.cross=ao,b.lerp=io,b.hermite=no,b.bezier=oo,b.random=so;var Fn=b.transformMat4=eo;b.transformMat3=ho,b.transformQuat=uo,b.rotateX=co,b.rotateY=lo,b.rotateZ=ro,b.angle=fo,b.zero=Mo,b.str=po,b.exactEquals=mo,b.equals=vo,b.forEach=b.sqrLen=b.len=b.sqrDist=b.dist=b.div=b.mul=b.sub=void 0;var G=zn(j);function _a(t){if(typeof WeakMap!="function")return null;var a=new WeakMap,i=new WeakMap;return(_a=function(n){return n?i:a})(t)}function zn(t,a){if(t&&t.__esModule)return t;if(t===null||mt(t)!=="object"&&typeof t!="function")return{default:t};var i=_a(a);if(i&&i.has(t))return i.get(t);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if(s!=="default"&&Object.prototype.hasOwnProperty.call(t,s)){var e=o?Object.getOwnPropertyDescriptor(t,s):null;e&&(e.get||e.set)?Object.defineProperty(n,s,e):n[s]=t[s]}return n.default=t,i&&i.set(t,n),n}function Ta(){var t=new G.ARRAY_TYPE(3);return G.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function jn(t){var a=new G.ARRAY_TYPE(3);return a[0]=t[0],a[1]=t[1],a[2]=t[2],a}function Aa(t){var a=t[0],i=t[1],n=t[2];return Math.hypot(a,i,n)}function qn(t,a,i){var n=new G.ARRAY_TYPE(3);return n[0]=t,n[1]=a,n[2]=i,n}function Wn(t,a){return t[0]=a[0],t[1]=a[1],t[2]=a[2],t}function Bn(t,a,i,n){return t[0]=a,t[1]=i,t[2]=n,t}function Zn(t,a,i){return t[0]=a[0]+i[0],t[1]=a[1]+i[1],t[2]=a[2]+i[2],t}function Ra(t,a,i){return t[0]=a[0]-i[0],t[1]=a[1]-i[1],t[2]=a[2]-i[2],t}function Pa(t,a,i){return t[0]=a[0]*i[0],t[1]=a[1]*i[1],t[2]=a[2]*i[2],t}function La(t,a,i){return t[0]=a[0]/i[0],t[1]=a[1]/i[1],t[2]=a[2]/i[2],t}function Xn(t,a){return t[0]=Math.ceil(a[0]),t[1]=Math.ceil(a[1]),t[2]=Math.ceil(a[2]),t}function Kn(t,a){return t[0]=Math.floor(a[0]),t[1]=Math.floor(a[1]),t[2]=Math.floor(a[2]),t}function Vn(t,a,i){return t[0]=Math.min(a[0],i[0]),t[1]=Math.min(a[1],i[1]),t[2]=Math.min(a[2],i[2]),t}function Un(t,a,i){return t[0]=Math.max(a[0],i[0]),t[1]=Math.max(a[1],i[1]),t[2]=Math.max(a[2],i[2]),t}function Gn(t,a){return t[0]=Math.round(a[0]),t[1]=Math.round(a[1]),t[2]=Math.round(a[2]),t}function $n(t,a,i){return t[0]=a[0]*i,t[1]=a[1]*i,t[2]=a[2]*i,t}function Hn(t,a,i,n){return t[0]=a[0]+i[0]*n,t[1]=a[1]+i[1]*n,t[2]=a[2]+i[2]*n,t}function Sa(t,a){var i=a[0]-t[0],n=a[1]-t[1],o=a[2]-t[2];return Math.hypot(i,n,o)}function Ca(t,a){var i=a[0]-t[0],n=a[1]-t[1],o=a[2]-t[2];return i*i+n*n+o*o}function wa(t){var a=t[0],i=t[1],n=t[2];return a*a+i*i+n*n}function Jn(t,a){return t[0]=-a[0],t[1]=-a[1],t[2]=-a[2],t}function Qn(t,a){return t[0]=1/a[0],t[1]=1/a[1],t[2]=1/a[2],t}function to(t,a){var i=a[0],n=a[1],o=a[2],s=i*i+n*n+o*o;return s>0&&(s=1/Math.sqrt(s)),t[0]=a[0]*s,t[1]=a[1]*s,t[2]=a[2]*s,t}function Na(t,a){return t[0]*a[0]+t[1]*a[1]+t[2]*a[2]}function ao(t,a,i){var n=a[0],o=a[1],s=a[2],e=i[0],h=i[1],u=i[2];return t[0]=o*u-s*h,t[1]=s*e-n*u,t[2]=n*h-o*e,t}function io(t,a,i,n){var o=a[0],s=a[1],e=a[2];return t[0]=o+n*(i[0]-o),t[1]=s+n*(i[1]-s),t[2]=e+n*(i[2]-e),t}function no(t,a,i,n,o,s){var e=s*s,h=e*(2*s-3)+1,u=e*(s-2)+s,c=e*(s-1),l=e*(3-2*s);return t[0]=a[0]*h+i[0]*u+n[0]*c+o[0]*l,t[1]=a[1]*h+i[1]*u+n[1]*c+o[1]*l,t[2]=a[2]*h+i[2]*u+n[2]*c+o[2]*l,t}function oo(t,a,i,n,o,s){var e=1-s,h=e*e,u=s*s,c=h*e,l=3*s*h,M=3*u*e,r=u*s;return t[0]=a[0]*c+i[0]*l+n[0]*M+o[0]*r,t[1]=a[1]*c+i[1]*l+n[1]*M+o[1]*r,t[2]=a[2]*c+i[2]*l+n[2]*M+o[2]*r,t}function so(t,a){a=a||1;var i=G.RANDOM()*2*Math.PI,n=G.RANDOM()*2-1,o=Math.sqrt(1-n*n)*a;return t[0]=Math.cos(i)*o,t[1]=Math.sin(i)*o,t[2]=n*a,t}function eo(t,a,i){var n=a[0],o=a[1],s=a[2],e=i[3]*n+i[7]*o+i[11]*s+i[15];return e=e||1,t[0]=(i[0]*n+i[4]*o+i[8]*s+i[12])/e,t[1]=(i[1]*n+i[5]*o+i[9]*s+i[13])/e,t[2]=(i[2]*n+i[6]*o+i[10]*s+i[14])/e,t}function ho(t,a,i){var n=a[0],o=a[1],s=a[2];return t[0]=n*i[0]+o*i[3]+s*i[6],t[1]=n*i[1]+o*i[4]+s*i[7],t[2]=n*i[2]+o*i[5]+s*i[8],t}function uo(t,a,i){var n=i[0],o=i[1],s=i[2],e=i[3],h=a[0],u=a[1],c=a[2],l=o*c-s*u,M=s*h-n*c,r=n*u-o*h,f=o*r-s*M,p=s*l-n*r,v=n*M-o*l,m=e*2;return l*=m,M*=m,r*=m,f*=2,p*=2,v*=2,t[0]=h+l+f,t[1]=u+M+p,t[2]=c+r+v,t}function co(t,a,i,n){var o=[],s=[];return o[0]=a[0]-i[0],o[1]=a[1]-i[1],o[2]=a[2]-i[2],s[0]=o[0],s[1]=o[1]*Math.cos(n)-o[2]*Math.sin(n),s[2]=o[1]*Math.sin(n)+o[2]*Math.cos(n),t[0]=s[0]+i[0],t[1]=s[1]+i[1],t[2]=s[2]+i[2],t}function lo(t,a,i,n){var o=[],s=[];return o[0]=a[0]-i[0],o[1]=a[1]-i[1],o[2]=a[2]-i[2],s[0]=o[2]*Math.sin(n)+o[0]*Math.cos(n),s[1]=o[1],s[2]=o[2]*Math.cos(n)-o[0]*Math.sin(n),t[0]=s[0]+i[0],t[1]=s[1]+i[1],t[2]=s[2]+i[2],t}function ro(t,a,i,n){var o=[],s=[];return o[0]=a[0]-i[0],o[1]=a[1]-i[1],o[2]=a[2]-i[2],s[0]=o[0]*Math.cos(n)-o[1]*Math.sin(n),s[1]=o[0]*Math.sin(n)+o[1]*Math.cos(n),s[2]=o[2],t[0]=s[0]+i[0],t[1]=s[1]+i[1],t[2]=s[2]+i[2],t}function fo(t,a){var i=t[0],n=t[1],o=t[2],s=a[0],e=a[1],h=a[2],u=Math.sqrt(i*i+n*n+o*o),c=Math.sqrt(s*s+e*e+h*h),l=u*c,M=l&&Na(t,a)/l;return Math.acos(Math.min(Math.max(M,-1),1))}function Mo(t){return t[0]=0,t[1]=0,t[2]=0,t}function po(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function mo(t,a){return t[0]===a[0]&&t[1]===a[1]&&t[2]===a[2]}function vo(t,a){var i=t[0],n=t[1],o=t[2],s=a[0],e=a[1],h=a[2];return Math.abs(i-s)<=G.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(n-e)<=G.EPSILON*Math.max(1,Math.abs(n),Math.abs(e))&&Math.abs(o-h)<=G.EPSILON*Math.max(1,Math.abs(o),Math.abs(h))}var yo=Ra;b.sub=yo;var go=Pa;b.mul=go;var xo=La;b.div=xo;var bo=Sa;b.dist=bo;var Eo=Ca;b.sqrDist=Eo;var Oo=Aa;b.len=Oo;var _o=wa;b.sqrLen=_o;var To=function(){var t=Ta();return function(a,i,n,o,s,e){var h,u;for(i||(i=3),n||(n=0),o?u=Math.min(o*i+n,a.length):u=a.length,h=n;h<u;h+=i)t[0]=a[h],t[1]=a[h+1],t[2]=a[h+2],s(t,t,e),a[h]=t[0],a[h+1]=t[1],a[h+2]=t[2];return a}}();b.forEach=To;class Ao extends Wi{toString(){let a="[";if(K.printRowMajor){a+="row-major:";for(let i=0;i<this.RANK;++i)for(let n=0;n<this.RANK;++n)a+=" ".concat(this[n*this.RANK+i])}else{a+="column-major:";for(let i=0;i<this.ELEMENTS;++i)a+=" ".concat(this[i])}return a+="]",a}getElementIndex(a,i){return i*this.RANK+a}getElement(a,i){return this[i*this.RANK+a]}setElement(a,i,n){return this[i*this.RANK+a]=Zi(n),this}getColumn(a,i=new Array(this.RANK).fill(-0)){const n=a*this.RANK;for(let o=0;o<this.RANK;++o)i[o]=this[n+o];return i}setColumn(a,i){const n=a*this.RANK;for(let o=0;o<this.RANK;++o)this[n+o]=i[o];return this}}var L={};function vt(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?vt=function(a){return typeof a}:vt=function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},vt(t)}Object.defineProperty(L,"__esModule",{value:!0}),L.create=Po,L.fromMat4=Lo,L.clone=So,L.copy=Co,L.fromValues=wo,L.set=No,L.identity=ko,L.transpose=Io,L.invert=Yo,L.adjoint=Do,L.determinant=Fo,L.multiply=Ia,L.translate=zo,L.rotate=jo,L.scale=qo,L.fromTranslation=Wo,L.fromRotation=Bo,L.fromScaling=Zo,L.fromMat2d=Xo,L.fromQuat=Ko,L.normalFromMat4=Vo,L.projection=Uo,L.str=Go,L.frob=$o,L.add=Ho,L.subtract=Ya,L.multiplyScalar=Jo,L.multiplyScalarAndAdd=Qo,L.exactEquals=ts,L.equals=as,L.sub=L.mul=void 0;var q=Ro(j);function ka(t){if(typeof WeakMap!="function")return null;var a=new WeakMap,i=new WeakMap;return(ka=function(n){return n?i:a})(t)}function Ro(t,a){if(t&&t.__esModule)return t;if(t===null||vt(t)!=="object"&&typeof t!="function")return{default:t};var i=ka(a);if(i&&i.has(t))return i.get(t);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if(s!=="default"&&Object.prototype.hasOwnProperty.call(t,s)){var e=o?Object.getOwnPropertyDescriptor(t,s):null;e&&(e.get||e.set)?Object.defineProperty(n,s,e):n[s]=t[s]}return n.default=t,i&&i.set(t,n),n}function Po(){var t=new q.ARRAY_TYPE(9);return q.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function Lo(t,a){return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[4],t[4]=a[5],t[5]=a[6],t[6]=a[8],t[7]=a[9],t[8]=a[10],t}function So(t){var a=new q.ARRAY_TYPE(9);return a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[4]=t[4],a[5]=t[5],a[6]=t[6],a[7]=t[7],a[8]=t[8],a}function Co(t,a){return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[4]=a[4],t[5]=a[5],t[6]=a[6],t[7]=a[7],t[8]=a[8],t}function wo(t,a,i,n,o,s,e,h,u){var c=new q.ARRAY_TYPE(9);return c[0]=t,c[1]=a,c[2]=i,c[3]=n,c[4]=o,c[5]=s,c[6]=e,c[7]=h,c[8]=u,c}function No(t,a,i,n,o,s,e,h,u,c){return t[0]=a,t[1]=i,t[2]=n,t[3]=o,t[4]=s,t[5]=e,t[6]=h,t[7]=u,t[8]=c,t}function ko(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Io(t,a){if(t===a){var i=a[1],n=a[2],o=a[5];t[1]=a[3],t[2]=a[6],t[3]=i,t[5]=a[7],t[6]=n,t[7]=o}else t[0]=a[0],t[1]=a[3],t[2]=a[6],t[3]=a[1],t[4]=a[4],t[5]=a[7],t[6]=a[2],t[7]=a[5],t[8]=a[8];return t}function Yo(t,a){var i=a[0],n=a[1],o=a[2],s=a[3],e=a[4],h=a[5],u=a[6],c=a[7],l=a[8],M=l*e-h*c,r=-l*s+h*u,f=c*s-e*u,p=i*M+n*r+o*f;return p?(p=1/p,t[0]=M*p,t[1]=(-l*n+o*c)*p,t[2]=(h*n-o*e)*p,t[3]=r*p,t[4]=(l*i-o*u)*p,t[5]=(-h*i+o*s)*p,t[6]=f*p,t[7]=(-c*i+n*u)*p,t[8]=(e*i-n*s)*p,t):null}function Do(t,a){var i=a[0],n=a[1],o=a[2],s=a[3],e=a[4],h=a[5],u=a[6],c=a[7],l=a[8];return t[0]=e*l-h*c,t[1]=o*c-n*l,t[2]=n*h-o*e,t[3]=h*u-s*l,t[4]=i*l-o*u,t[5]=o*s-i*h,t[6]=s*c-e*u,t[7]=n*u-i*c,t[8]=i*e-n*s,t}function Fo(t){var a=t[0],i=t[1],n=t[2],o=t[3],s=t[4],e=t[5],h=t[6],u=t[7],c=t[8];return a*(c*s-e*u)+i*(-c*o+e*h)+n*(u*o-s*h)}function Ia(t,a,i){var n=a[0],o=a[1],s=a[2],e=a[3],h=a[4],u=a[5],c=a[6],l=a[7],M=a[8],r=i[0],f=i[1],p=i[2],v=i[3],m=i[4],d=i[5],O=i[6],y=i[7],g=i[8];return t[0]=r*n+f*e+p*c,t[1]=r*o+f*h+p*l,t[2]=r*s+f*u+p*M,t[3]=v*n+m*e+d*c,t[4]=v*o+m*h+d*l,t[5]=v*s+m*u+d*M,t[6]=O*n+y*e+g*c,t[7]=O*o+y*h+g*l,t[8]=O*s+y*u+g*M,t}function zo(t,a,i){var n=a[0],o=a[1],s=a[2],e=a[3],h=a[4],u=a[5],c=a[6],l=a[7],M=a[8],r=i[0],f=i[1];return t[0]=n,t[1]=o,t[2]=s,t[3]=e,t[4]=h,t[5]=u,t[6]=r*n+f*e+c,t[7]=r*o+f*h+l,t[8]=r*s+f*u+M,t}function jo(t,a,i){var n=a[0],o=a[1],s=a[2],e=a[3],h=a[4],u=a[5],c=a[6],l=a[7],M=a[8],r=Math.sin(i),f=Math.cos(i);return t[0]=f*n+r*e,t[1]=f*o+r*h,t[2]=f*s+r*u,t[3]=f*e-r*n,t[4]=f*h-r*o,t[5]=f*u-r*s,t[6]=c,t[7]=l,t[8]=M,t}function qo(t,a,i){var n=i[0],o=i[1];return t[0]=n*a[0],t[1]=n*a[1],t[2]=n*a[2],t[3]=o*a[3],t[4]=o*a[4],t[5]=o*a[5],t[6]=a[6],t[7]=a[7],t[8]=a[8],t}function Wo(t,a){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=a[0],t[7]=a[1],t[8]=1,t}function Bo(t,a){var i=Math.sin(a),n=Math.cos(a);return t[0]=n,t[1]=i,t[2]=0,t[3]=-i,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Zo(t,a){return t[0]=a[0],t[1]=0,t[2]=0,t[3]=0,t[4]=a[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Xo(t,a){return t[0]=a[0],t[1]=a[1],t[2]=0,t[3]=a[2],t[4]=a[3],t[5]=0,t[6]=a[4],t[7]=a[5],t[8]=1,t}function Ko(t,a){var i=a[0],n=a[1],o=a[2],s=a[3],e=i+i,h=n+n,u=o+o,c=i*e,l=n*e,M=n*h,r=o*e,f=o*h,p=o*u,v=s*e,m=s*h,d=s*u;return t[0]=1-M-p,t[3]=l-d,t[6]=r+m,t[1]=l+d,t[4]=1-c-p,t[7]=f-v,t[2]=r-m,t[5]=f+v,t[8]=1-c-M,t}function Vo(t,a){var i=a[0],n=a[1],o=a[2],s=a[3],e=a[4],h=a[5],u=a[6],c=a[7],l=a[8],M=a[9],r=a[10],f=a[11],p=a[12],v=a[13],m=a[14],d=a[15],O=i*h-n*e,y=i*u-o*e,g=i*c-s*e,T=n*u-o*h,R=n*c-s*h,I=o*c-s*u,w=l*v-M*p,N=l*m-r*p,S=l*d-f*p,Y=M*m-r*v,k=M*d-f*v,D=r*d-f*m,P=O*D-y*k+g*Y+T*S-R*N+I*w;return P?(P=1/P,t[0]=(h*D-u*k+c*Y)*P,t[1]=(u*S-e*D-c*N)*P,t[2]=(e*k-h*S+c*w)*P,t[3]=(o*k-n*D-s*Y)*P,t[4]=(i*D-o*S+s*N)*P,t[5]=(n*S-i*k-s*w)*P,t[6]=(v*I-m*R+d*T)*P,t[7]=(m*g-p*I-d*y)*P,t[8]=(p*R-v*g+d*O)*P,t):null}function Uo(t,a,i){return t[0]=2/a,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/i,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function Go(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function $o(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}function Ho(t,a,i){return t[0]=a[0]+i[0],t[1]=a[1]+i[1],t[2]=a[2]+i[2],t[3]=a[3]+i[3],t[4]=a[4]+i[4],t[5]=a[5]+i[5],t[6]=a[6]+i[6],t[7]=a[7]+i[7],t[8]=a[8]+i[8],t}function Ya(t,a,i){return t[0]=a[0]-i[0],t[1]=a[1]-i[1],t[2]=a[2]-i[2],t[3]=a[3]-i[3],t[4]=a[4]-i[4],t[5]=a[5]-i[5],t[6]=a[6]-i[6],t[7]=a[7]-i[7],t[8]=a[8]-i[8],t}function Jo(t,a,i){return t[0]=a[0]*i,t[1]=a[1]*i,t[2]=a[2]*i,t[3]=a[3]*i,t[4]=a[4]*i,t[5]=a[5]*i,t[6]=a[6]*i,t[7]=a[7]*i,t[8]=a[8]*i,t}function Qo(t,a,i,n){return t[0]=a[0]+i[0]*n,t[1]=a[1]+i[1]*n,t[2]=a[2]+i[2]*n,t[3]=a[3]+i[3]*n,t[4]=a[4]+i[4]*n,t[5]=a[5]+i[5]*n,t[6]=a[6]+i[6]*n,t[7]=a[7]+i[7]*n,t[8]=a[8]+i[8]*n,t}function ts(t,a){return t[0]===a[0]&&t[1]===a[1]&&t[2]===a[2]&&t[3]===a[3]&&t[4]===a[4]&&t[5]===a[5]&&t[6]===a[6]&&t[7]===a[7]&&t[8]===a[8]}function as(t,a){var i=t[0],n=t[1],o=t[2],s=t[3],e=t[4],h=t[5],u=t[6],c=t[7],l=t[8],M=a[0],r=a[1],f=a[2],p=a[3],v=a[4],m=a[5],d=a[6],O=a[7],y=a[8];return Math.abs(i-M)<=q.EPSILON*Math.max(1,Math.abs(i),Math.abs(M))&&Math.abs(n-r)<=q.EPSILON*Math.max(1,Math.abs(n),Math.abs(r))&&Math.abs(o-f)<=q.EPSILON*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(s-p)<=q.EPSILON*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(e-v)<=q.EPSILON*Math.max(1,Math.abs(e),Math.abs(v))&&Math.abs(h-m)<=q.EPSILON*Math.max(1,Math.abs(h),Math.abs(m))&&Math.abs(u-d)<=q.EPSILON*Math.max(1,Math.abs(u),Math.abs(d))&&Math.abs(c-O)<=q.EPSILON*Math.max(1,Math.abs(c),Math.abs(O))&&Math.abs(l-y)<=q.EPSILON*Math.max(1,Math.abs(l),Math.abs(y))}var is=Ia;L.mul=is;var ns=Ya;L.sub=ns;var Gt;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL1ROW0=3]="COL1ROW0",t[t.COL1ROW1=4]="COL1ROW1",t[t.COL1ROW2=5]="COL1ROW2",t[t.COL2ROW0=6]="COL2ROW0",t[t.COL2ROW1=7]="COL2ROW1",t[t.COL2ROW2=8]="COL2ROW2"})(Gt||(Gt={}));var E={};function yt(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?yt=function(a){return typeof a}:yt=function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},yt(t)}Object.defineProperty(E,"__esModule",{value:!0}),E.create=ys,E.clone=ds,E.copy=gs,E.fromValues=xs,E.set=bs,E.identity=Fa;var os=E.transpose=Es,ss=E.invert=Os;E.adjoint=_s;var es=E.determinant=Ts,$t=E.multiply=za,hs=E.translate=As,us=E.scale=Rs,cs=E.rotate=Ps,ls=E.rotateX=Ls,rs=E.rotateY=Ss,fs=E.rotateZ=Cs;E.fromTranslation=ws,E.fromScaling=Ns,E.fromRotation=ks,E.fromXRotation=Is,E.fromYRotation=Ys,E.fromZRotation=Ds,E.fromRotationTranslation=ja,E.fromQuat2=Fs,E.getTranslation=zs,E.getScaling=qa,E.getRotation=js,E.fromRotationTranslationScale=qs,E.fromRotationTranslationScaleOrigin=Ws;var Ms=E.fromQuat=Bs,ps=E.frustum=Zs;E.perspectiveNO=Wa,E.perspectiveZO=Ks,E.perspectiveFromFieldOfView=Vs,E.orthoNO=Za,E.orthoZO=Gs;var ms=E.lookAt=$s;E.targetTo=Hs,E.str=Js,E.frob=Qs,E.add=t1,E.subtract=Ka,E.multiplyScalar=a1,E.multiplyScalarAndAdd=i1,E.exactEquals=n1,E.equals=o1,E.sub=E.mul=Xa=E.ortho=Ba=E.perspective=void 0;var C=vs(j);function Da(t){if(typeof WeakMap!="function")return null;var a=new WeakMap,i=new WeakMap;return(Da=function(n){return n?i:a})(t)}function vs(t,a){if(t&&t.__esModule)return t;if(t===null||yt(t)!=="object"&&typeof t!="function")return{default:t};var i=Da(a);if(i&&i.has(t))return i.get(t);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if(s!=="default"&&Object.prototype.hasOwnProperty.call(t,s)){var e=o?Object.getOwnPropertyDescriptor(t,s):null;e&&(e.get||e.set)?Object.defineProperty(n,s,e):n[s]=t[s]}return n.default=t,i&&i.set(t,n),n}function ys(){var t=new C.ARRAY_TYPE(16);return C.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function ds(t){var a=new C.ARRAY_TYPE(16);return a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[4]=t[4],a[5]=t[5],a[6]=t[6],a[7]=t[7],a[8]=t[8],a[9]=t[9],a[10]=t[10],a[11]=t[11],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15],a}function gs(t,a){return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[4]=a[4],t[5]=a[5],t[6]=a[6],t[7]=a[7],t[8]=a[8],t[9]=a[9],t[10]=a[10],t[11]=a[11],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15],t}function xs(t,a,i,n,o,s,e,h,u,c,l,M,r,f,p,v){var m=new C.ARRAY_TYPE(16);return m[0]=t,m[1]=a,m[2]=i,m[3]=n,m[4]=o,m[5]=s,m[6]=e,m[7]=h,m[8]=u,m[9]=c,m[10]=l,m[11]=M,m[12]=r,m[13]=f,m[14]=p,m[15]=v,m}function bs(t,a,i,n,o,s,e,h,u,c,l,M,r,f,p,v,m){return t[0]=a,t[1]=i,t[2]=n,t[3]=o,t[4]=s,t[5]=e,t[6]=h,t[7]=u,t[8]=c,t[9]=l,t[10]=M,t[11]=r,t[12]=f,t[13]=p,t[14]=v,t[15]=m,t}function Fa(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Es(t,a){if(t===a){var i=a[1],n=a[2],o=a[3],s=a[6],e=a[7],h=a[11];t[1]=a[4],t[2]=a[8],t[3]=a[12],t[4]=i,t[6]=a[9],t[7]=a[13],t[8]=n,t[9]=s,t[11]=a[14],t[12]=o,t[13]=e,t[14]=h}else t[0]=a[0],t[1]=a[4],t[2]=a[8],t[3]=a[12],t[4]=a[1],t[5]=a[5],t[6]=a[9],t[7]=a[13],t[8]=a[2],t[9]=a[6],t[10]=a[10],t[11]=a[14],t[12]=a[3],t[13]=a[7],t[14]=a[11],t[15]=a[15];return t}function Os(t,a){var i=a[0],n=a[1],o=a[2],s=a[3],e=a[4],h=a[5],u=a[6],c=a[7],l=a[8],M=a[9],r=a[10],f=a[11],p=a[12],v=a[13],m=a[14],d=a[15],O=i*h-n*e,y=i*u-o*e,g=i*c-s*e,T=n*u-o*h,R=n*c-s*h,I=o*c-s*u,w=l*v-M*p,N=l*m-r*p,S=l*d-f*p,Y=M*m-r*v,k=M*d-f*v,D=r*d-f*m,P=O*D-y*k+g*Y+T*S-R*N+I*w;return P?(P=1/P,t[0]=(h*D-u*k+c*Y)*P,t[1]=(o*k-n*D-s*Y)*P,t[2]=(v*I-m*R+d*T)*P,t[3]=(r*R-M*I-f*T)*P,t[4]=(u*S-e*D-c*N)*P,t[5]=(i*D-o*S+s*N)*P,t[6]=(m*g-p*I-d*y)*P,t[7]=(l*I-r*g+f*y)*P,t[8]=(e*k-h*S+c*w)*P,t[9]=(n*S-i*k-s*w)*P,t[10]=(p*R-v*g+d*O)*P,t[11]=(M*g-l*R-f*O)*P,t[12]=(h*N-e*Y-u*w)*P,t[13]=(i*Y-n*N+o*w)*P,t[14]=(v*y-p*T-m*O)*P,t[15]=(l*T-M*y+r*O)*P,t):null}function _s(t,a){var i=a[0],n=a[1],o=a[2],s=a[3],e=a[4],h=a[5],u=a[6],c=a[7],l=a[8],M=a[9],r=a[10],f=a[11],p=a[12],v=a[13],m=a[14],d=a[15];return t[0]=h*(r*d-f*m)-M*(u*d-c*m)+v*(u*f-c*r),t[1]=-(n*(r*d-f*m)-M*(o*d-s*m)+v*(o*f-s*r)),t[2]=n*(u*d-c*m)-h*(o*d-s*m)+v*(o*c-s*u),t[3]=-(n*(u*f-c*r)-h*(o*f-s*r)+M*(o*c-s*u)),t[4]=-(e*(r*d-f*m)-l*(u*d-c*m)+p*(u*f-c*r)),t[5]=i*(r*d-f*m)-l*(o*d-s*m)+p*(o*f-s*r),t[6]=-(i*(u*d-c*m)-e*(o*d-s*m)+p*(o*c-s*u)),t[7]=i*(u*f-c*r)-e*(o*f-s*r)+l*(o*c-s*u),t[8]=e*(M*d-f*v)-l*(h*d-c*v)+p*(h*f-c*M),t[9]=-(i*(M*d-f*v)-l*(n*d-s*v)+p*(n*f-s*M)),t[10]=i*(h*d-c*v)-e*(n*d-s*v)+p*(n*c-s*h),t[11]=-(i*(h*f-c*M)-e*(n*f-s*M)+l*(n*c-s*h)),t[12]=-(e*(M*m-r*v)-l*(h*m-u*v)+p*(h*r-u*M)),t[13]=i*(M*m-r*v)-l*(n*m-o*v)+p*(n*r-o*M),t[14]=-(i*(h*m-u*v)-e*(n*m-o*v)+p*(n*u-o*h)),t[15]=i*(h*r-u*M)-e*(n*r-o*M)+l*(n*u-o*h),t}function Ts(t){var a=t[0],i=t[1],n=t[2],o=t[3],s=t[4],e=t[5],h=t[6],u=t[7],c=t[8],l=t[9],M=t[10],r=t[11],f=t[12],p=t[13],v=t[14],m=t[15],d=a*e-i*s,O=a*h-n*s,y=a*u-o*s,g=i*h-n*e,T=i*u-o*e,R=n*u-o*h,I=c*p-l*f,w=c*v-M*f,N=c*m-r*f,S=l*v-M*p,Y=l*m-r*p,k=M*m-r*v;return d*k-O*Y+y*S+g*N-T*w+R*I}function za(t,a,i){var n=a[0],o=a[1],s=a[2],e=a[3],h=a[4],u=a[5],c=a[6],l=a[7],M=a[8],r=a[9],f=a[10],p=a[11],v=a[12],m=a[13],d=a[14],O=a[15],y=i[0],g=i[1],T=i[2],R=i[3];return t[0]=y*n+g*h+T*M+R*v,t[1]=y*o+g*u+T*r+R*m,t[2]=y*s+g*c+T*f+R*d,t[3]=y*e+g*l+T*p+R*O,y=i[4],g=i[5],T=i[6],R=i[7],t[4]=y*n+g*h+T*M+R*v,t[5]=y*o+g*u+T*r+R*m,t[6]=y*s+g*c+T*f+R*d,t[7]=y*e+g*l+T*p+R*O,y=i[8],g=i[9],T=i[10],R=i[11],t[8]=y*n+g*h+T*M+R*v,t[9]=y*o+g*u+T*r+R*m,t[10]=y*s+g*c+T*f+R*d,t[11]=y*e+g*l+T*p+R*O,y=i[12],g=i[13],T=i[14],R=i[15],t[12]=y*n+g*h+T*M+R*v,t[13]=y*o+g*u+T*r+R*m,t[14]=y*s+g*c+T*f+R*d,t[15]=y*e+g*l+T*p+R*O,t}function As(t,a,i){var n=i[0],o=i[1],s=i[2],e,h,u,c,l,M,r,f,p,v,m,d;return a===t?(t[12]=a[0]*n+a[4]*o+a[8]*s+a[12],t[13]=a[1]*n+a[5]*o+a[9]*s+a[13],t[14]=a[2]*n+a[6]*o+a[10]*s+a[14],t[15]=a[3]*n+a[7]*o+a[11]*s+a[15]):(e=a[0],h=a[1],u=a[2],c=a[3],l=a[4],M=a[5],r=a[6],f=a[7],p=a[8],v=a[9],m=a[10],d=a[11],t[0]=e,t[1]=h,t[2]=u,t[3]=c,t[4]=l,t[5]=M,t[6]=r,t[7]=f,t[8]=p,t[9]=v,t[10]=m,t[11]=d,t[12]=e*n+l*o+p*s+a[12],t[13]=h*n+M*o+v*s+a[13],t[14]=u*n+r*o+m*s+a[14],t[15]=c*n+f*o+d*s+a[15]),t}function Rs(t,a,i){var n=i[0],o=i[1],s=i[2];return t[0]=a[0]*n,t[1]=a[1]*n,t[2]=a[2]*n,t[3]=a[3]*n,t[4]=a[4]*o,t[5]=a[5]*o,t[6]=a[6]*o,t[7]=a[7]*o,t[8]=a[8]*s,t[9]=a[9]*s,t[10]=a[10]*s,t[11]=a[11]*s,t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15],t}function Ps(t,a,i,n){var o=n[0],s=n[1],e=n[2],h=Math.hypot(o,s,e),u,c,l,M,r,f,p,v,m,d,O,y,g,T,R,I,w,N,S,Y,k,D,P,X;return h<C.EPSILON?null:(h=1/h,o*=h,s*=h,e*=h,u=Math.sin(i),c=Math.cos(i),l=1-c,M=a[0],r=a[1],f=a[2],p=a[3],v=a[4],m=a[5],d=a[6],O=a[7],y=a[8],g=a[9],T=a[10],R=a[11],I=o*o*l+c,w=s*o*l+e*u,N=e*o*l-s*u,S=o*s*l-e*u,Y=s*s*l+c,k=e*s*l+o*u,D=o*e*l+s*u,P=s*e*l-o*u,X=e*e*l+c,t[0]=M*I+v*w+y*N,t[1]=r*I+m*w+g*N,t[2]=f*I+d*w+T*N,t[3]=p*I+O*w+R*N,t[4]=M*S+v*Y+y*k,t[5]=r*S+m*Y+g*k,t[6]=f*S+d*Y+T*k,t[7]=p*S+O*Y+R*k,t[8]=M*D+v*P+y*X,t[9]=r*D+m*P+g*X,t[10]=f*D+d*P+T*X,t[11]=p*D+O*P+R*X,a!==t&&(t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15]),t)}function Ls(t,a,i){var n=Math.sin(i),o=Math.cos(i),s=a[4],e=a[5],h=a[6],u=a[7],c=a[8],l=a[9],M=a[10],r=a[11];return a!==t&&(t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15]),t[4]=s*o+c*n,t[5]=e*o+l*n,t[6]=h*o+M*n,t[7]=u*o+r*n,t[8]=c*o-s*n,t[9]=l*o-e*n,t[10]=M*o-h*n,t[11]=r*o-u*n,t}function Ss(t,a,i){var n=Math.sin(i),o=Math.cos(i),s=a[0],e=a[1],h=a[2],u=a[3],c=a[8],l=a[9],M=a[10],r=a[11];return a!==t&&(t[4]=a[4],t[5]=a[5],t[6]=a[6],t[7]=a[7],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15]),t[0]=s*o-c*n,t[1]=e*o-l*n,t[2]=h*o-M*n,t[3]=u*o-r*n,t[8]=s*n+c*o,t[9]=e*n+l*o,t[10]=h*n+M*o,t[11]=u*n+r*o,t}function Cs(t,a,i){var n=Math.sin(i),o=Math.cos(i),s=a[0],e=a[1],h=a[2],u=a[3],c=a[4],l=a[5],M=a[6],r=a[7];return a!==t&&(t[8]=a[8],t[9]=a[9],t[10]=a[10],t[11]=a[11],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15]),t[0]=s*o+c*n,t[1]=e*o+l*n,t[2]=h*o+M*n,t[3]=u*o+r*n,t[4]=c*o-s*n,t[5]=l*o-e*n,t[6]=M*o-h*n,t[7]=r*o-u*n,t}function ws(t,a){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=a[0],t[13]=a[1],t[14]=a[2],t[15]=1,t}function Ns(t,a){return t[0]=a[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=a[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ks(t,a,i){var n=i[0],o=i[1],s=i[2],e=Math.hypot(n,o,s),h,u,c;return e<C.EPSILON?null:(e=1/e,n*=e,o*=e,s*=e,h=Math.sin(a),u=Math.cos(a),c=1-u,t[0]=n*n*c+u,t[1]=o*n*c+s*h,t[2]=s*n*c-o*h,t[3]=0,t[4]=n*o*c-s*h,t[5]=o*o*c+u,t[6]=s*o*c+n*h,t[7]=0,t[8]=n*s*c+o*h,t[9]=o*s*c-n*h,t[10]=s*s*c+u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function Is(t,a){var i=Math.sin(a),n=Math.cos(a);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=i,t[7]=0,t[8]=0,t[9]=-i,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Ys(t,a){var i=Math.sin(a),n=Math.cos(a);return t[0]=n,t[1]=0,t[2]=-i,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=i,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Ds(t,a){var i=Math.sin(a),n=Math.cos(a);return t[0]=n,t[1]=i,t[2]=0,t[3]=0,t[4]=-i,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ja(t,a,i){var n=a[0],o=a[1],s=a[2],e=a[3],h=n+n,u=o+o,c=s+s,l=n*h,M=n*u,r=n*c,f=o*u,p=o*c,v=s*c,m=e*h,d=e*u,O=e*c;return t[0]=1-(f+v),t[1]=M+O,t[2]=r-d,t[3]=0,t[4]=M-O,t[5]=1-(l+v),t[6]=p+m,t[7]=0,t[8]=r+d,t[9]=p-m,t[10]=1-(l+f),t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t}function Fs(t,a){var i=new C.ARRAY_TYPE(3),n=-a[0],o=-a[1],s=-a[2],e=a[3],h=a[4],u=a[5],c=a[6],l=a[7],M=n*n+o*o+s*s+e*e;return M>0?(i[0]=(h*e+l*n+u*s-c*o)*2/M,i[1]=(u*e+l*o+c*n-h*s)*2/M,i[2]=(c*e+l*s+h*o-u*n)*2/M):(i[0]=(h*e+l*n+u*s-c*o)*2,i[1]=(u*e+l*o+c*n-h*s)*2,i[2]=(c*e+l*s+h*o-u*n)*2),ja(t,a,i),t}function zs(t,a){return t[0]=a[12],t[1]=a[13],t[2]=a[14],t}function qa(t,a){var i=a[0],n=a[1],o=a[2],s=a[4],e=a[5],h=a[6],u=a[8],c=a[9],l=a[10];return t[0]=Math.hypot(i,n,o),t[1]=Math.hypot(s,e,h),t[2]=Math.hypot(u,c,l),t}function js(t,a){var i=new C.ARRAY_TYPE(3);qa(i,a);var n=1/i[0],o=1/i[1],s=1/i[2],e=a[0]*n,h=a[1]*o,u=a[2]*s,c=a[4]*n,l=a[5]*o,M=a[6]*s,r=a[8]*n,f=a[9]*o,p=a[10]*s,v=e+l+p,m=0;return v>0?(m=Math.sqrt(v+1)*2,t[3]=.25*m,t[0]=(M-f)/m,t[1]=(r-u)/m,t[2]=(h-c)/m):e>l&&e>p?(m=Math.sqrt(1+e-l-p)*2,t[3]=(M-f)/m,t[0]=.25*m,t[1]=(h+c)/m,t[2]=(r+u)/m):l>p?(m=Math.sqrt(1+l-e-p)*2,t[3]=(r-u)/m,t[0]=(h+c)/m,t[1]=.25*m,t[2]=(M+f)/m):(m=Math.sqrt(1+p-e-l)*2,t[3]=(h-c)/m,t[0]=(r+u)/m,t[1]=(M+f)/m,t[2]=.25*m),t}function qs(t,a,i,n){var o=a[0],s=a[1],e=a[2],h=a[3],u=o+o,c=s+s,l=e+e,M=o*u,r=o*c,f=o*l,p=s*c,v=s*l,m=e*l,d=h*u,O=h*c,y=h*l,g=n[0],T=n[1],R=n[2];return t[0]=(1-(p+m))*g,t[1]=(r+y)*g,t[2]=(f-O)*g,t[3]=0,t[4]=(r-y)*T,t[5]=(1-(M+m))*T,t[6]=(v+d)*T,t[7]=0,t[8]=(f+O)*R,t[9]=(v-d)*R,t[10]=(1-(M+p))*R,t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t}function Ws(t,a,i,n,o){var s=a[0],e=a[1],h=a[2],u=a[3],c=s+s,l=e+e,M=h+h,r=s*c,f=s*l,p=s*M,v=e*l,m=e*M,d=h*M,O=u*c,y=u*l,g=u*M,T=n[0],R=n[1],I=n[2],w=o[0],N=o[1],S=o[2],Y=(1-(v+d))*T,k=(f+g)*T,D=(p-y)*T,P=(f-g)*R,X=(1-(r+d))*R,tt=(m+O)*R,at=(p+y)*I,Xt=(m-O)*I,Kt=(1-(r+v))*I;return t[0]=Y,t[1]=k,t[2]=D,t[3]=0,t[4]=P,t[5]=X,t[6]=tt,t[7]=0,t[8]=at,t[9]=Xt,t[10]=Kt,t[11]=0,t[12]=i[0]+w-(Y*w+P*N+at*S),t[13]=i[1]+N-(k*w+X*N+Xt*S),t[14]=i[2]+S-(D*w+tt*N+Kt*S),t[15]=1,t}function Bs(t,a){var i=a[0],n=a[1],o=a[2],s=a[3],e=i+i,h=n+n,u=o+o,c=i*e,l=n*e,M=n*h,r=o*e,f=o*h,p=o*u,v=s*e,m=s*h,d=s*u;return t[0]=1-M-p,t[1]=l+d,t[2]=r-m,t[3]=0,t[4]=l-d,t[5]=1-c-p,t[6]=f+v,t[7]=0,t[8]=r+m,t[9]=f-v,t[10]=1-c-M,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Zs(t,a,i,n,o,s,e){var h=1/(i-a),u=1/(o-n),c=1/(s-e);return t[0]=s*2*h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s*2*u,t[6]=0,t[7]=0,t[8]=(i+a)*h,t[9]=(o+n)*u,t[10]=(e+s)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=e*s*2*c,t[15]=0,t}function Wa(t,a,i,n,o){var s=1/Math.tan(a/2),e;return t[0]=s/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,o!=null&&o!==1/0?(e=1/(n-o),t[10]=(o+n)*e,t[14]=2*o*n*e):(t[10]=-1,t[14]=-2*n),t}var Xs=Wa,Ba=E.perspective=Xs;function Ks(t,a,i,n,o){var s=1/Math.tan(a/2),e;return t[0]=s/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,o!=null&&o!==1/0?(e=1/(n-o),t[10]=o*e,t[14]=o*n*e):(t[10]=-1,t[14]=-n),t}function Vs(t,a,i,n){var o=Math.tan(a.upDegrees*Math.PI/180),s=Math.tan(a.downDegrees*Math.PI/180),e=Math.tan(a.leftDegrees*Math.PI/180),h=Math.tan(a.rightDegrees*Math.PI/180),u=2/(e+h),c=2/(o+s);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-((e-h)*u*.5),t[9]=(o-s)*c*.5,t[10]=n/(i-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*i/(i-n),t[15]=0,t}function Za(t,a,i,n,o,s,e){var h=1/(a-i),u=1/(n-o),c=1/(s-e);return t[0]=-2*h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(a+i)*h,t[13]=(o+n)*u,t[14]=(e+s)*c,t[15]=1,t}var Us=Za,Xa=E.ortho=Us;function Gs(t,a,i,n,o,s,e){var h=1/(a-i),u=1/(n-o),c=1/(s-e);return t[0]=-2*h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=c,t[11]=0,t[12]=(a+i)*h,t[13]=(o+n)*u,t[14]=s*c,t[15]=1,t}function $s(t,a,i,n){var o,s,e,h,u,c,l,M,r,f,p=a[0],v=a[1],m=a[2],d=n[0],O=n[1],y=n[2],g=i[0],T=i[1],R=i[2];return Math.abs(p-g)<C.EPSILON&&Math.abs(v-T)<C.EPSILON&&Math.abs(m-R)<C.EPSILON?Fa(t):(l=p-g,M=v-T,r=m-R,f=1/Math.hypot(l,M,r),l*=f,M*=f,r*=f,o=O*r-y*M,s=y*l-d*r,e=d*M-O*l,f=Math.hypot(o,s,e),f?(f=1/f,o*=f,s*=f,e*=f):(o=0,s=0,e=0),h=M*e-r*s,u=r*o-l*e,c=l*s-M*o,f=Math.hypot(h,u,c),f?(f=1/f,h*=f,u*=f,c*=f):(h=0,u=0,c=0),t[0]=o,t[1]=h,t[2]=l,t[3]=0,t[4]=s,t[5]=u,t[6]=M,t[7]=0,t[8]=e,t[9]=c,t[10]=r,t[11]=0,t[12]=-(o*p+s*v+e*m),t[13]=-(h*p+u*v+c*m),t[14]=-(l*p+M*v+r*m),t[15]=1,t)}function Hs(t,a,i,n){var o=a[0],s=a[1],e=a[2],h=n[0],u=n[1],c=n[2],l=o-i[0],M=s-i[1],r=e-i[2],f=l*l+M*M+r*r;f>0&&(f=1/Math.sqrt(f),l*=f,M*=f,r*=f);var p=u*r-c*M,v=c*l-h*r,m=h*M-u*l;return f=p*p+v*v+m*m,f>0&&(f=1/Math.sqrt(f),p*=f,v*=f,m*=f),t[0]=p,t[1]=v,t[2]=m,t[3]=0,t[4]=M*m-r*v,t[5]=r*p-l*m,t[6]=l*v-M*p,t[7]=0,t[8]=l,t[9]=M,t[10]=r,t[11]=0,t[12]=o,t[13]=s,t[14]=e,t[15]=1,t}function Js(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function Qs(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function t1(t,a,i){return t[0]=a[0]+i[0],t[1]=a[1]+i[1],t[2]=a[2]+i[2],t[3]=a[3]+i[3],t[4]=a[4]+i[4],t[5]=a[5]+i[5],t[6]=a[6]+i[6],t[7]=a[7]+i[7],t[8]=a[8]+i[8],t[9]=a[9]+i[9],t[10]=a[10]+i[10],t[11]=a[11]+i[11],t[12]=a[12]+i[12],t[13]=a[13]+i[13],t[14]=a[14]+i[14],t[15]=a[15]+i[15],t}function Ka(t,a,i){return t[0]=a[0]-i[0],t[1]=a[1]-i[1],t[2]=a[2]-i[2],t[3]=a[3]-i[3],t[4]=a[4]-i[4],t[5]=a[5]-i[5],t[6]=a[6]-i[6],t[7]=a[7]-i[7],t[8]=a[8]-i[8],t[9]=a[9]-i[9],t[10]=a[10]-i[10],t[11]=a[11]-i[11],t[12]=a[12]-i[12],t[13]=a[13]-i[13],t[14]=a[14]-i[14],t[15]=a[15]-i[15],t}function a1(t,a,i){return t[0]=a[0]*i,t[1]=a[1]*i,t[2]=a[2]*i,t[3]=a[3]*i,t[4]=a[4]*i,t[5]=a[5]*i,t[6]=a[6]*i,t[7]=a[7]*i,t[8]=a[8]*i,t[9]=a[9]*i,t[10]=a[10]*i,t[11]=a[11]*i,t[12]=a[12]*i,t[13]=a[13]*i,t[14]=a[14]*i,t[15]=a[15]*i,t}function i1(t,a,i,n){return t[0]=a[0]+i[0]*n,t[1]=a[1]+i[1]*n,t[2]=a[2]+i[2]*n,t[3]=a[3]+i[3]*n,t[4]=a[4]+i[4]*n,t[5]=a[5]+i[5]*n,t[6]=a[6]+i[6]*n,t[7]=a[7]+i[7]*n,t[8]=a[8]+i[8]*n,t[9]=a[9]+i[9]*n,t[10]=a[10]+i[10]*n,t[11]=a[11]+i[11]*n,t[12]=a[12]+i[12]*n,t[13]=a[13]+i[13]*n,t[14]=a[14]+i[14]*n,t[15]=a[15]+i[15]*n,t}function n1(t,a){return t[0]===a[0]&&t[1]===a[1]&&t[2]===a[2]&&t[3]===a[3]&&t[4]===a[4]&&t[5]===a[5]&&t[6]===a[6]&&t[7]===a[7]&&t[8]===a[8]&&t[9]===a[9]&&t[10]===a[10]&&t[11]===a[11]&&t[12]===a[12]&&t[13]===a[13]&&t[14]===a[14]&&t[15]===a[15]}function o1(t,a){var i=t[0],n=t[1],o=t[2],s=t[3],e=t[4],h=t[5],u=t[6],c=t[7],l=t[8],M=t[9],r=t[10],f=t[11],p=t[12],v=t[13],m=t[14],d=t[15],O=a[0],y=a[1],g=a[2],T=a[3],R=a[4],I=a[5],w=a[6],N=a[7],S=a[8],Y=a[9],k=a[10],D=a[11],P=a[12],X=a[13],tt=a[14],at=a[15];return Math.abs(i-O)<=C.EPSILON*Math.max(1,Math.abs(i),Math.abs(O))&&Math.abs(n-y)<=C.EPSILON*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(o-g)<=C.EPSILON*Math.max(1,Math.abs(o),Math.abs(g))&&Math.abs(s-T)<=C.EPSILON*Math.max(1,Math.abs(s),Math.abs(T))&&Math.abs(e-R)<=C.EPSILON*Math.max(1,Math.abs(e),Math.abs(R))&&Math.abs(h-I)<=C.EPSILON*Math.max(1,Math.abs(h),Math.abs(I))&&Math.abs(u-w)<=C.EPSILON*Math.max(1,Math.abs(u),Math.abs(w))&&Math.abs(c-N)<=C.EPSILON*Math.max(1,Math.abs(c),Math.abs(N))&&Math.abs(l-S)<=C.EPSILON*Math.max(1,Math.abs(l),Math.abs(S))&&Math.abs(M-Y)<=C.EPSILON*Math.max(1,Math.abs(M),Math.abs(Y))&&Math.abs(r-k)<=C.EPSILON*Math.max(1,Math.abs(r),Math.abs(k))&&Math.abs(f-D)<=C.EPSILON*Math.max(1,Math.abs(f),Math.abs(D))&&Math.abs(p-P)<=C.EPSILON*Math.max(1,Math.abs(p),Math.abs(P))&&Math.abs(v-X)<=C.EPSILON*Math.max(1,Math.abs(v),Math.abs(X))&&Math.abs(m-tt)<=C.EPSILON*Math.max(1,Math.abs(m),Math.abs(tt))&&Math.abs(d-at)<=C.EPSILON*Math.max(1,Math.abs(d),Math.abs(at))}var s1=za;E.mul=s1;var e1=Ka;E.sub=e1;var A={};function dt(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?dt=function(a){return typeof a}:dt=function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},dt(t)}Object.defineProperty(A,"__esModule",{value:!0}),A.create=Ua,A.clone=c1,A.fromValues=l1,A.copy=r1,A.set=f1,A.add=M1,A.subtract=Ga,A.multiply=$a,A.divide=Ha,A.ceil=p1,A.floor=m1,A.min=v1,A.max=y1,A.round=d1,A.scale=g1,A.scaleAndAdd=x1,A.distance=Ja,A.squaredDistance=Qa,A.length=ti,A.squaredLength=ai,A.negate=b1,A.inverse=E1,A.normalize=O1,A.dot=_1,A.cross=T1,A.lerp=A1,A.random=R1;var h1=A.transformMat4=P1;A.transformQuat=L1,A.zero=S1,A.str=C1,A.exactEquals=w1,A.equals=N1,A.forEach=A.sqrLen=A.len=A.sqrDist=A.dist=A.div=A.mul=A.sub=void 0;var Z=u1(j);function Va(t){if(typeof WeakMap!="function")return null;var a=new WeakMap,i=new WeakMap;return(Va=function(n){return n?i:a})(t)}function u1(t,a){if(t&&t.__esModule)return t;if(t===null||dt(t)!=="object"&&typeof t!="function")return{default:t};var i=Va(a);if(i&&i.has(t))return i.get(t);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if(s!=="default"&&Object.prototype.hasOwnProperty.call(t,s)){var e=o?Object.getOwnPropertyDescriptor(t,s):null;e&&(e.get||e.set)?Object.defineProperty(n,s,e):n[s]=t[s]}return n.default=t,i&&i.set(t,n),n}function Ua(){var t=new Z.ARRAY_TYPE(4);return Z.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function c1(t){var a=new Z.ARRAY_TYPE(4);return a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a}function l1(t,a,i,n){var o=new Z.ARRAY_TYPE(4);return o[0]=t,o[1]=a,o[2]=i,o[3]=n,o}function r1(t,a){return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t}function f1(t,a,i,n,o){return t[0]=a,t[1]=i,t[2]=n,t[3]=o,t}function M1(t,a,i){return t[0]=a[0]+i[0],t[1]=a[1]+i[1],t[2]=a[2]+i[2],t[3]=a[3]+i[3],t}function Ga(t,a,i){return t[0]=a[0]-i[0],t[1]=a[1]-i[1],t[2]=a[2]-i[2],t[3]=a[3]-i[3],t}function $a(t,a,i){return t[0]=a[0]*i[0],t[1]=a[1]*i[1],t[2]=a[2]*i[2],t[3]=a[3]*i[3],t}function Ha(t,a,i){return t[0]=a[0]/i[0],t[1]=a[1]/i[1],t[2]=a[2]/i[2],t[3]=a[3]/i[3],t}function p1(t,a){return t[0]=Math.ceil(a[0]),t[1]=Math.ceil(a[1]),t[2]=Math.ceil(a[2]),t[3]=Math.ceil(a[3]),t}function m1(t,a){return t[0]=Math.floor(a[0]),t[1]=Math.floor(a[1]),t[2]=Math.floor(a[2]),t[3]=Math.floor(a[3]),t}function v1(t,a,i){return t[0]=Math.min(a[0],i[0]),t[1]=Math.min(a[1],i[1]),t[2]=Math.min(a[2],i[2]),t[3]=Math.min(a[3],i[3]),t}function y1(t,a,i){return t[0]=Math.max(a[0],i[0]),t[1]=Math.max(a[1],i[1]),t[2]=Math.max(a[2],i[2]),t[3]=Math.max(a[3],i[3]),t}function d1(t,a){return t[0]=Math.round(a[0]),t[1]=Math.round(a[1]),t[2]=Math.round(a[2]),t[3]=Math.round(a[3]),t}function g1(t,a,i){return t[0]=a[0]*i,t[1]=a[1]*i,t[2]=a[2]*i,t[3]=a[3]*i,t}function x1(t,a,i,n){return t[0]=a[0]+i[0]*n,t[1]=a[1]+i[1]*n,t[2]=a[2]+i[2]*n,t[3]=a[3]+i[3]*n,t}function Ja(t,a){var i=a[0]-t[0],n=a[1]-t[1],o=a[2]-t[2],s=a[3]-t[3];return Math.hypot(i,n,o,s)}function Qa(t,a){var i=a[0]-t[0],n=a[1]-t[1],o=a[2]-t[2],s=a[3]-t[3];return i*i+n*n+o*o+s*s}function ti(t){var a=t[0],i=t[1],n=t[2],o=t[3];return Math.hypot(a,i,n,o)}function ai(t){var a=t[0],i=t[1],n=t[2],o=t[3];return a*a+i*i+n*n+o*o}function b1(t,a){return t[0]=-a[0],t[1]=-a[1],t[2]=-a[2],t[3]=-a[3],t}function E1(t,a){return t[0]=1/a[0],t[1]=1/a[1],t[2]=1/a[2],t[3]=1/a[3],t}function O1(t,a){var i=a[0],n=a[1],o=a[2],s=a[3],e=i*i+n*n+o*o+s*s;return e>0&&(e=1/Math.sqrt(e)),t[0]=i*e,t[1]=n*e,t[2]=o*e,t[3]=s*e,t}function _1(t,a){return t[0]*a[0]+t[1]*a[1]+t[2]*a[2]+t[3]*a[3]}function T1(t,a,i,n){var o=i[0]*n[1]-i[1]*n[0],s=i[0]*n[2]-i[2]*n[0],e=i[0]*n[3]-i[3]*n[0],h=i[1]*n[2]-i[2]*n[1],u=i[1]*n[3]-i[3]*n[1],c=i[2]*n[3]-i[3]*n[2],l=a[0],M=a[1],r=a[2],f=a[3];return t[0]=M*c-r*u+f*h,t[1]=-(l*c)+r*e-f*s,t[2]=l*u-M*e+f*o,t[3]=-(l*h)+M*s-r*o,t}function A1(t,a,i,n){var o=a[0],s=a[1],e=a[2],h=a[3];return t[0]=o+n*(i[0]-o),t[1]=s+n*(i[1]-s),t[2]=e+n*(i[2]-e),t[3]=h+n*(i[3]-h),t}function R1(t,a){a=a||1;var i,n,o,s,e,h;do i=Z.RANDOM()*2-1,n=Z.RANDOM()*2-1,e=i*i+n*n;while(e>=1);do o=Z.RANDOM()*2-1,s=Z.RANDOM()*2-1,h=o*o+s*s;while(h>=1);var u=Math.sqrt((1-e)/h);return t[0]=a*i,t[1]=a*n,t[2]=a*o*u,t[3]=a*s*u,t}function P1(t,a,i){var n=a[0],o=a[1],s=a[2],e=a[3];return t[0]=i[0]*n+i[4]*o+i[8]*s+i[12]*e,t[1]=i[1]*n+i[5]*o+i[9]*s+i[13]*e,t[2]=i[2]*n+i[6]*o+i[10]*s+i[14]*e,t[3]=i[3]*n+i[7]*o+i[11]*s+i[15]*e,t}function L1(t,a,i){var n=a[0],o=a[1],s=a[2],e=i[0],h=i[1],u=i[2],c=i[3],l=c*n+h*s-u*o,M=c*o+u*n-e*s,r=c*s+e*o-h*n,f=-e*n-h*o-u*s;return t[0]=l*c+f*-e+M*-u-r*-h,t[1]=M*c+f*-h+r*-e-l*-u,t[2]=r*c+f*-u+l*-h-M*-e,t[3]=a[3],t}function S1(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function C1(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function w1(t,a){return t[0]===a[0]&&t[1]===a[1]&&t[2]===a[2]&&t[3]===a[3]}function N1(t,a){var i=t[0],n=t[1],o=t[2],s=t[3],e=a[0],h=a[1],u=a[2],c=a[3];return Math.abs(i-e)<=Z.EPSILON*Math.max(1,Math.abs(i),Math.abs(e))&&Math.abs(n-h)<=Z.EPSILON*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(o-u)<=Z.EPSILON*Math.max(1,Math.abs(o),Math.abs(u))&&Math.abs(s-c)<=Z.EPSILON*Math.max(1,Math.abs(s),Math.abs(c))}var k1=Ga;A.sub=k1;var I1=$a;A.mul=I1;var Y1=Ha;A.div=Y1;var D1=Ja;A.dist=D1;var F1=Qa;A.sqrDist=F1;var z1=ti;A.len=z1;var j1=ai;A.sqrLen=j1;var q1=function(){var t=Ua();return function(a,i,n,o,s,e){var h,u;for(i||(i=4),n||(n=0),o?u=Math.min(o*i+n,a.length):u=a.length,h=n;h<u;h+=i)t[0]=a[h],t[1]=a[h+1],t[2]=a[h+2],t[3]=a[h+3],s(t,t,e),a[h]=t[0],a[h+1]=t[1],a[h+2]=t[2],a[h+3]=t[3];return a}}();A.forEach=q1;var qt;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(qt||(qt={}));const W1=45*Math.PI/180,B1=1,wt=.1,Nt=500,Z1=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class ot extends Ao{static get IDENTITY(){return K1()}static get ZERO(){return X1()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return qt}constructor(a){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(a)?this.copy(a):this.identity()}copy(a){return this[0]=a[0],this[1]=a[1],this[2]=a[2],this[3]=a[3],this[4]=a[4],this[5]=a[5],this[6]=a[6],this[7]=a[7],this[8]=a[8],this[9]=a[9],this[10]=a[10],this[11]=a[11],this[12]=a[12],this[13]=a[13],this[14]=a[14],this[15]=a[15],this.check()}set(a,i,n,o,s,e,h,u,c,l,M,r,f,p,v,m){return this[0]=a,this[1]=i,this[2]=n,this[3]=o,this[4]=s,this[5]=e,this[6]=h,this[7]=u,this[8]=c,this[9]=l,this[10]=M,this[11]=r,this[12]=f,this[13]=p,this[14]=v,this[15]=m,this.check()}setRowMajor(a,i,n,o,s,e,h,u,c,l,M,r,f,p,v,m){return this[0]=a,this[1]=s,this[2]=c,this[3]=f,this[4]=i,this[5]=e,this[6]=l,this[7]=p,this[8]=n,this[9]=h,this[10]=M,this[11]=v,this[12]=o,this[13]=u,this[14]=r,this[15]=m,this.check()}toRowMajor(a){return a[0]=this[0],a[1]=this[4],a[2]=this[8],a[3]=this[12],a[4]=this[1],a[5]=this[5],a[6]=this[9],a[7]=this[13],a[8]=this[2],a[9]=this[6],a[10]=this[10],a[11]=this[14],a[12]=this[3],a[13]=this[7],a[14]=this[11],a[15]=this[15],a}identity(){return this.copy(Z1)}fromObject(a){return this.check()}fromQuaternion(a){return Ms(this,a),this.check()}frustum(a){const{left:i,right:n,bottom:o,top:s,near:e=wt,far:h=Nt}=a;return h===1/0?V1(this,i,n,o,s,e):ps(this,i,n,o,s,e,h),this.check()}lookAt(a){const{eye:i,center:n=[0,0,0],up:o=[0,1,0]}=a;return ms(this,i,n,o),this.check()}ortho(a){const{left:i,right:n,bottom:o,top:s,near:e=wt,far:h=Nt}=a;return Xa(this,i,n,o,s,e,h),this.check()}orthographic(a){const{fovy:i=W1,aspect:n=B1,focalDistance:o=1,near:s=wt,far:e=Nt}=a;Ht(i);const h=i/2,u=o*Math.tan(h),c=u*n;return this.ortho({left:-c,right:c,bottom:-u,top:u,near:s,far:e})}perspective(a){const{fovy:i=45*Math.PI/180,aspect:n=1,near:o=.1,far:s=500}=a;return Ht(i),Ba(this,i,n,o,s),this.check()}determinant(){return es(this)}getScale(a=[-0,-0,-0]){return a[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),a[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),a[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),a}getTranslation(a=[-0,-0,-0]){return a[0]=this[12],a[1]=this[13],a[2]=this[14],a}getRotation(a,i){a=a||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],i=i||[-0,-0,-0];const n=this.getScale(i),o=1/n[0],s=1/n[1],e=1/n[2];return a[0]=this[0]*o,a[1]=this[1]*s,a[2]=this[2]*e,a[3]=0,a[4]=this[4]*o,a[5]=this[5]*s,a[6]=this[6]*e,a[7]=0,a[8]=this[8]*o,a[9]=this[9]*s,a[10]=this[10]*e,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}getRotationMatrix3(a,i){a=a||[-0,-0,-0,-0,-0,-0,-0,-0,-0],i=i||[-0,-0,-0];const n=this.getScale(i),o=1/n[0],s=1/n[1],e=1/n[2];return a[0]=this[0]*o,a[1]=this[1]*s,a[2]=this[2]*e,a[3]=this[4]*o,a[4]=this[5]*s,a[5]=this[6]*e,a[6]=this[8]*o,a[7]=this[9]*s,a[8]=this[10]*e,a}transpose(){return os(this,this),this.check()}invert(){return ss(this,this),this.check()}multiplyLeft(a){return $t(this,a,this),this.check()}multiplyRight(a){return $t(this,this,a),this.check()}rotateX(a){return ls(this,this,a),this.check()}rotateY(a){return rs(this,this,a),this.check()}rotateZ(a){return fs(this,this,a),this.check()}rotateXYZ(a){return this.rotateX(a[0]).rotateY(a[1]).rotateZ(a[2])}rotateAxis(a,i){return cs(this,this,a,i),this.check()}scale(a){return us(this,this,Array.isArray(a)?a:[a,a,a]),this.check()}translate(a){return hs(this,this,a),this.check()}transform(a,i){return a.length===4?(i=h1(i||[-0,-0,-0,-0],a,this),Ct(i,4),i):this.transformAsPoint(a,i)}transformAsPoint(a,i){const{length:n}=a;let o;switch(n){case 2:o=$i(i||[-0,-0],a,this);break;case 3:o=Fn(i||[-0,-0,-0],a,this);break;default:throw new Error("Illegal vector")}return Ct(o,a.length),o}transformAsVector(a,i){let n;switch(a.length){case 2:n=Yn(i||[-0,-0],a,this);break;case 3:n=Dn(i||[-0,-0,-0],a,this);break;default:throw new Error("Illegal vector")}return Ct(n,a.length),n}transformPoint(a,i){return this.transformAsPoint(a,i)}transformVector(a,i){return this.transformAsPoint(a,i)}transformDirection(a,i){return this.transformAsVector(a,i)}makeRotationX(a){return this.identity().rotateX(a)}makeTranslation(a,i,n){return this.identity().translate([a,i,n])}}let rt,ft;function X1(){return rt||(rt=new ot([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(rt)),rt}function K1(){return ft||(ft=new ot,Object.freeze(ft)),ft}function Ht(t){if(t>Math.PI*2)throw Error("expected radians")}function V1(t,a,i,n,o,s){const e=2*s/(i-a),h=2*s/(o-n),u=(i+a)/(i-a),c=(o+n)/(o-n),l=-1,M=-1,r=-2*s;return t[0]=e,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=h,t[6]=0,t[7]=0,t[8]=u,t[9]=c,t[10]=l,t[11]=M,t[12]=0,t[13]=0,t[14]=r,t[15]=0,t}var x={};function gt(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?gt=function(a){return typeof a}:gt=function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},gt(t)}Object.defineProperty(x,"__esModule",{value:!0}),x.create=Wt,x.identity=G1,x.setAxisAngle=ni,x.getAxisAngle=$1,x.getAngle=H1,x.multiply=oi,x.rotateX=J1,x.rotateY=Q1,x.rotateZ=te,x.calculateW=ae,x.exp=si,x.ln=ei,x.pow=ie,x.slerp=xt,x.random=ne,x.invert=oe,x.conjugate=se,x.fromMat3=hi,x.fromEuler=ee,x.str=he,x.setAxes=x.sqlerp=x.rotationTo=x.equals=x.exactEquals=x.normalize=x.sqrLen=x.squaredLength=x.len=x.length=x.lerp=x.dot=x.scale=x.mul=x.add=x.set=x.copy=x.fromValues=x.clone=void 0;var $=Lt(j),U1=Lt(L),V=Lt(b),W=Lt(A);function ii(t){if(typeof WeakMap!="function")return null;var a=new WeakMap,i=new WeakMap;return(ii=function(n){return n?i:a})(t)}function Lt(t,a){if(t&&t.__esModule)return t;if(t===null||gt(t)!=="object"&&typeof t!="function")return{default:t};var i=ii(a);if(i&&i.has(t))return i.get(t);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if(s!=="default"&&Object.prototype.hasOwnProperty.call(t,s)){var e=o?Object.getOwnPropertyDescriptor(t,s):null;e&&(e.get||e.set)?Object.defineProperty(n,s,e):n[s]=t[s]}return n.default=t,i&&i.set(t,n),n}function Wt(){var t=new $.ARRAY_TYPE(4);return $.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function G1(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function ni(t,a,i){i=i*.5;var n=Math.sin(i);return t[0]=n*a[0],t[1]=n*a[1],t[2]=n*a[2],t[3]=Math.cos(i),t}function $1(t,a){var i=Math.acos(a[3])*2,n=Math.sin(i/2);return n>$.EPSILON?(t[0]=a[0]/n,t[1]=a[1]/n,t[2]=a[2]/n):(t[0]=1,t[1]=0,t[2]=0),i}function H1(t,a){var i=ci(t,a);return Math.acos(2*i*i-1)}function oi(t,a,i){var n=a[0],o=a[1],s=a[2],e=a[3],h=i[0],u=i[1],c=i[2],l=i[3];return t[0]=n*l+e*h+o*c-s*u,t[1]=o*l+e*u+s*h-n*c,t[2]=s*l+e*c+n*u-o*h,t[3]=e*l-n*h-o*u-s*c,t}function J1(t,a,i){i*=.5;var n=a[0],o=a[1],s=a[2],e=a[3],h=Math.sin(i),u=Math.cos(i);return t[0]=n*u+e*h,t[1]=o*u+s*h,t[2]=s*u-o*h,t[3]=e*u-n*h,t}function Q1(t,a,i){i*=.5;var n=a[0],o=a[1],s=a[2],e=a[3],h=Math.sin(i),u=Math.cos(i);return t[0]=n*u-s*h,t[1]=o*u+e*h,t[2]=s*u+n*h,t[3]=e*u-o*h,t}function te(t,a,i){i*=.5;var n=a[0],o=a[1],s=a[2],e=a[3],h=Math.sin(i),u=Math.cos(i);return t[0]=n*u+o*h,t[1]=o*u-n*h,t[2]=s*u+e*h,t[3]=e*u-s*h,t}function ae(t,a){var i=a[0],n=a[1],o=a[2];return t[0]=i,t[1]=n,t[2]=o,t[3]=Math.sqrt(Math.abs(1-i*i-n*n-o*o)),t}function si(t,a){var i=a[0],n=a[1],o=a[2],s=a[3],e=Math.sqrt(i*i+n*n+o*o),h=Math.exp(s),u=e>0?h*Math.sin(e)/e:0;return t[0]=i*u,t[1]=n*u,t[2]=o*u,t[3]=h*Math.cos(e),t}function ei(t,a){var i=a[0],n=a[1],o=a[2],s=a[3],e=Math.sqrt(i*i+n*n+o*o),h=e>0?Math.atan2(e,s)/e:0;return t[0]=i*h,t[1]=n*h,t[2]=o*h,t[3]=.5*Math.log(i*i+n*n+o*o+s*s),t}function ie(t,a,i){return ei(t,a),ui(t,t,i),si(t,t),t}function xt(t,a,i,n){var o=a[0],s=a[1],e=a[2],h=a[3],u=i[0],c=i[1],l=i[2],M=i[3],r,f,p,v,m;return f=o*u+s*c+e*l+h*M,f<0&&(f=-f,u=-u,c=-c,l=-l,M=-M),1-f>$.EPSILON?(r=Math.acos(f),p=Math.sin(r),v=Math.sin((1-n)*r)/p,m=Math.sin(n*r)/p):(v=1-n,m=n),t[0]=v*o+m*u,t[1]=v*s+m*c,t[2]=v*e+m*l,t[3]=v*h+m*M,t}function ne(t){var a=$.RANDOM(),i=$.RANDOM(),n=$.RANDOM(),o=Math.sqrt(1-a),s=Math.sqrt(a);return t[0]=o*Math.sin(2*Math.PI*i),t[1]=o*Math.cos(2*Math.PI*i),t[2]=s*Math.sin(2*Math.PI*n),t[3]=s*Math.cos(2*Math.PI*n),t}function oe(t,a){var i=a[0],n=a[1],o=a[2],s=a[3],e=i*i+n*n+o*o+s*s,h=e?1/e:0;return t[0]=-i*h,t[1]=-n*h,t[2]=-o*h,t[3]=s*h,t}function se(t,a){return t[0]=-a[0],t[1]=-a[1],t[2]=-a[2],t[3]=a[3],t}function hi(t,a){var i=a[0]+a[4]+a[8],n;if(i>0)n=Math.sqrt(i+1),t[3]=.5*n,n=.5/n,t[0]=(a[5]-a[7])*n,t[1]=(a[6]-a[2])*n,t[2]=(a[1]-a[3])*n;else{var o=0;a[4]>a[0]&&(o=1),a[8]>a[o*3+o]&&(o=2);var s=(o+1)%3,e=(o+2)%3;n=Math.sqrt(a[o*3+o]-a[s*3+s]-a[e*3+e]+1),t[o]=.5*n,n=.5/n,t[3]=(a[s*3+e]-a[e*3+s])*n,t[s]=(a[s*3+o]+a[o*3+s])*n,t[e]=(a[e*3+o]+a[o*3+e])*n}return t}function ee(t,a,i,n){var o=.5*Math.PI/180;a*=o,i*=o,n*=o;var s=Math.sin(a),e=Math.cos(a),h=Math.sin(i),u=Math.cos(i),c=Math.sin(n),l=Math.cos(n);return t[0]=s*u*l-e*h*c,t[1]=e*h*l+s*u*c,t[2]=e*u*c-s*h*l,t[3]=e*u*l+s*h*c,t}function he(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var ue=W.clone;x.clone=ue;var ce=W.fromValues;x.fromValues=ce;var le=W.copy;x.copy=le;var re=W.set;x.set=re;var fe=W.add;x.add=fe;var Me=oi;x.mul=Me;var ui=W.scale;x.scale=ui;var ci=W.dot;x.dot=ci;var pe=W.lerp;x.lerp=pe;var li=W.length;x.length=li;var me=li;x.len=me;var ri=W.squaredLength;x.squaredLength=ri;var ve=ri;x.sqrLen=ve;var Zt=W.normalize;x.normalize=Zt;var ye=W.exactEquals;x.exactEquals=ye;var de=W.equals;x.equals=de;var ge=function(){var t=V.create(),a=V.fromValues(1,0,0),i=V.fromValues(0,1,0);return function(n,o,s){var e=V.dot(o,s);return e<-.999999?(V.cross(t,a,o),V.len(t)<1e-6&&V.cross(t,i,o),V.normalize(t,t),ni(n,t,Math.PI),n):e>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(V.cross(t,o,s),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1+e,Zt(n,n))}}();x.rotationTo=ge;var xe=function(){var t=Wt(),a=Wt();return function(i,n,o,s,e,h){return xt(t,n,e,h),xt(a,o,s,h),xt(i,t,a,2*h*(1-h)),i}}();x.sqlerp=xe;var be=function(){var t=U1.create();return function(a,i,n,o){return t[0]=n[0],t[3]=n[1],t[6]=n[2],t[1]=o[0],t[4]=o[1],t[7]=o[2],t[2]=-i[0],t[5]=-i[1],t[8]=-i[2],Zt(a,hi(a,t))}}();x.setAxes=be;var Jt;(function(t){t[t.ZYX=0]="ZYX",t[t.YXZ=1]="YXZ",t[t.XZY=2]="XZY",t[t.ZXY=3]="ZXY",t[t.YZX=4]="YZX",t[t.XYZ=5]="XYZ"})(Jt||(Jt={}));const F=3.141592653589793,_t=6378245,Tt=.006693421622965943,At=F*3e3/180;function nt(t,a,i){const n=F/180*a,o=Math.pow(2,i),s=Math.floor((t+180)/360*o),e=Math.floor((1-Math.asinh(Math.tan(n))/F)/2*o);return[s,e]}function Qt(t,a,i){const n=Math.pow(2,i),o=t/n*360-180,s=Math.atan(Math.sinh(F*(1-2*a/n)))*180/F;return[o,s]}function Ee(t,a){let i=fi(t-105,a-35),n=Mi(t-105,a-35);const o=a/180*F;let s=Math.sin(o);s=1-Tt*s*s;const e=Math.sqrt(s);i=i*180/(_t*(1-Tt)/(s*e)*F),n=n*180/(_t/e*Math.cos(o)*F);const h=a+i;return{lng:t+n,lat:h}}function ta(t,a){const i=_e(t,a),n=t*2-i.lng,o=a*2-i.lat;return{lng:n,lat:o}}function ia(t,a){const i=Math.sqrt(t*t+a*a)+2e-5*Math.sin(a*At),n=Math.atan2(a,t)+3e-6*Math.cos(t*At),o=i*Math.cos(n)+.0065,s=i*Math.sin(n)+.006;return{lng:o,lat:s}}function Oe(t,a){const i=t-.0065,n=a-.006,o=Math.sqrt(i*i+n*n)-2e-5*Math.sin(n*At),s=Math.atan2(n,i)-3e-6*Math.cos(i*At),e=o*Math.cos(s),h=o*Math.sin(s);return{lng:e,lat:h}}function _e(t,a){let i=fi(t-105,a-35),n=Mi(t-105,a-35);const o=a/180*F;let s=Math.sin(o);s=1-Tt*s*s;const e=Math.sqrt(s);i=i*180/(_t*(1-Tt)/(s*e)*F),n=n*180/(_t/e*Math.cos(o)*F);const h=a+i;return{lng:t+n,lat:h}}function fi(t,a){let i=-100+2*t+3*a+.2*a*a+.1*t*a+.2*Math.sqrt(Math.abs(t));return i+=(20*Math.sin(6*t*F)+20*Math.sin(2*t*F))*2/3,i+=(20*Math.sin(a*F)+40*Math.sin(a/3*F))*2/3,i+=(160*Math.sin(a/12*F)+320*Math.sin(a*F/30))*2/3,i}function Mi(t,a){let i=300+t+2*a+.1*t*t+.1*t*a+.1*Math.sqrt(Math.abs(t));return i+=(20*Math.sin(6*t*F)+20*Math.sin(2*t*F))*2/3,i+=(20*Math.sin(t*F)+40*Math.sin(t/3*F))*2/3,i+=(150*Math.sin(t/12*F)+300*Math.sin(t/30*F))*2/3,i}function na(t,a){for(var i in a)a.hasOwnProperty(i)&&(t[i]=a[i]);return t}function Te(t,a){for(var i in a)t[i]=a[i]}function oa(t){return typeof t=="string"}var sa=void 0,Mt=null;function B(t,a){isNaN(t)&&(t=Ib(t),t=isNaN(t)?0:t),oa(t)&&(t=parseFloat(t)),isNaN(a)&&(a=Ib(a),a=isNaN(a)?0:a),oa(a)&&(a=parseFloat(a)),this.lng=t,this.lat=a}B.TL=function(t){return t&&180>=t.lng&&-180<=t.lng&&74>=t.lat&&-74<=t.lat},B.prototype.lb=function(t){return t&&this.lat==t.lat&&this.lng==t.lng};function Rt(t,a){this.x=t||0,this.y=a||0,this.x=this.x,this.y=this.y}Rt.prototype.lb=function(t){return t&&t.x==this.x&&t.y==this.y};function Bt(){}Bt.prototype.nh=function(){aa("lngLatToPoint")},Bt.prototype.wi=function(){aa("pointToLngLat")};function U(){}U.prototype=new Bt,na(U,{$O:637099681e-2,lG:[1289059486e-2,836237787e-2,5591021,348198983e-2,167804312e-2,0],Au:[75,60,45,30,15,0],fP:[[1410526172116255e-23,898305509648872e-20,-1.9939833816331,200.9824383106796,-187.2403703815547,91.6087516669843,-23.38765649603339,2.57121317296198,-.03801003308653,173379812e-1],[-7435856389565537e-24,8983055097726239e-21,-.78625201886289,96.32687599759846,-1.85204757529826,-59.36935905485877,47.40033549296737,-16.50741931063887,2.28786674699375,1026014486e-2],[-3030883460898826e-23,898305509983578e-20,.30071316287616,59.74293618442277,7.357984074871,-25.38371002664745,13.45380521110908,-3.29883767235584,.32710905363475,685681737e-2],[-1981981304930552e-23,8983055099779535e-21,.03278182852591,40.31678527705744,.65659298677277,-4.44255534477492,.85341911805263,.12923347998204,-.04625736007561,448277706e-2],[309191371068437e-23,8983055096812155e-21,6995724062e-14,23.10934304144901,-.00023663490511,-.6321817810242,-.00663494467273,.03430082397953,-.00466043876332,25551644e-1],[2890871144776878e-24,8983055095805407e-21,-3068298e-14,7.47137025468032,-353937994e-14,-.02145144861037,-1234426596e-14,.00010322952773,-323890364e-14,826088.5]],iG:[[-.0015702102444,111320.7020616939,0x60e374c3105a3,-0x24bb4115e2e164,0x5cc55543bb0ae8,-0x7ce070193f3784,0x5e7ca61ddf8150,-0x261a578d8b24d0,0x665d60f3742ca,82.5],[.0008277824516172526,111320.7020463578,6477955746671607e-7,-4082003173641316e-6,1077490566351142e-5,-1517187553151559e-5,1205306533862167e-5,-5124939663577472e-6,9133119359512032e-7,67.5],[.00337398766765,111320.7020202162,4481351045890365e-9,-2339375119931662e-8,7968221547186455e-8,-1159649932797253e-7,9723671115602145e-8,-4366194633752821e-8,8477230501135234e-9,52.5],[.00220636496208,111320.7020209128,51751.86112841131,3796837749470245e-9,992013.7397791013,-122195221711287e-8,1340652697009075e-9,-620943.6990984312,144416.9293806241,37.5],[-.0003441963504368392,111320.7020576856,278.2353980772752,2485758690035394e-9,6070.750963243378,54821.18345352118,9540.606633304236,-2710.55326746645,1405.483844121726,22.5],[-.0003218135878613132,111320.7020701615,.00369383431289,823725.6402795718,.46104986909093,2351.343141331292,1.58060784298199,8.77738589078284,.37238884252424,7.45]],Z1:function(o,a){if(!o||!a)return 0;var i,n,o=this.Fb(o);return o?(i=this.Tk(o.lng),n=this.Tk(o.lat),a=this.Fb(a),a?this.Pe(i,this.Tk(a.lng),n,this.Tk(a.lat)):0):0},Vo:function(t,a){return!t||!a?0:(t.lng=this.JD(t.lng,-180,180),t.lat=this.ND(t.lat,-74,74),a.lng=this.JD(a.lng,-180,180),a.lat=this.ND(a.lat,-74,74),this.Pe(this.Tk(t.lng),this.Tk(a.lng),this.Tk(t.lat),this.Tk(a.lat)))},Fb:function(t){if(t===Mt||t===sa)return new B(0,0);var a,i;a=new B(Math.abs(t.lng),Math.abs(t.lat));for(var n=0;n<this.lG.length;n++)if(a.lat>=this.lG[n]){i=this.fP[n];break}return t=this.gK(t,i),t=new B(t.lng.toFixed(6),t.lat.toFixed(6))},Eb:function(t){if(t===Mt||t===sa||180<t.lng||-180>t.lng||90<t.lat||-90>t.lat)return new B(0,0);var a,i;t.lng=this.JD(t.lng,-180,180),t.lat=this.ND(t.lat,-74,74),a=new B(t.lng,t.lat);for(var n=0;n<this.Au.length;n++)if(a.lat>=this.Au[n]){i=this.iG[n];break}if(!i){for(n=0;n<this.Au.length;n++)if(a.lat<=-this.Au[n]){i=this.iG[n];break}}return t=this.gK(t,i),t=new B(t.lng.toFixed(2),t.lat.toFixed(2))},gK:function(t,a){if(t&&a){var i=a[0]+a[1]*Math.abs(t.lng),n=Math.abs(t.lat)/a[9],n=a[2]+a[3]*n+a[4]*n*n+a[5]*n*n*n+a[6]*n*n*n*n+a[7]*n*n*n*n*n+a[8]*n*n*n*n*n*n,i=i*(0>t.lng?-1:1),n=n*(0>t.lat?-1:1);return new B(i,n)}},Pe:function(t,a,i,n){return this.$O*Math.acos(Math.sin(i)*Math.sin(n)+Math.cos(i)*Math.cos(n)*Math.cos(a-t))},Tk:function(t){return Math.PI*t/180},Z3:function(t){return 180*t/Math.PI},ND:function(t,a,i){return a!=Mt&&(t=Math.max(t,a)),i!=Mt&&(t=Math.min(t,i)),t},JD:function(t,a,i){for(;t>i;)t-=i-a;for(;t<a;)t+=i-a;return t}}),na(U.prototype,{Jm:function(t){return U.Eb(t)},nh:function(t){return t=U.Eb(t),new Rt(t.lng,t.lat)},qh:function(t){return U.Fb(t)},wi:function(t){return t=new B(t.x,t.y),U.Fb(t)},fc:function(t,a,i,n,o){if(t)return t=this.Jm(t,o),a=this.Lc(a),new Rt(Math.round((t.lng-i.lng)/a+n.width/2),Math.round((i.lat-t.lat)/a+n.height/2))},zb:function(t,a,i,n,o){if(t)return a=this.Lc(a),this.qh(new B(i.lng+a*(t.x-n.width/2),i.lat-a*(t.y-n.height/2)),o)},Lc:function(t){return Math.pow(2,18-t)}});var kt=U.prototype;Te(kt,{lngLatToPoint:kt.nh,pointToLngLat:kt.wi});let It={Point:B,Pixel:Rt,MercatorProjection:U};class Ae{constructor(a,i){this.projection=new It.MercatorProjection,this.levelMax=a,this.levelMin=i}_getRetain(a){return Math.pow(2,a-18)}getResolution(a,i){return Math.pow(2,18-i)*Math.cos(a)}lnglatToPoint(a,i){let n=new It.Point(a,i),o=this.projection.lngLatToPoint(n);return{pointX:o.x,pointY:o.y}}pointToLnglat(a,i){let n=new It.Pixel(a,i),o=this.projection.pointToLngLat(n);return{lng:o.lng,lat:o.lat}}_lngToTileX(a,i){let n=this.lnglatToPoint(a,0);return Math.floor(n.pointX*this._getRetain(i)/256)}_latToTileY(a,i){let n=this.lnglatToPoint(0,a);return Math.floor(n.pointY*this._getRetain(i)/256)}lnglatToTile(a,i,n){let o=this._lngToTileX(a,n),s=this._latToTileY(i,n);return[o,s]}_lngToPixelX(a,i){let n=this._lngToTileX(a,i),o=this.lnglatToPoint(a,0);return Math.floor(o.pointX*this._getRetain(i)-n*256)}_latToPixelY(a,i){let n=this._latToTileY(a,i),o=this.lnglatToPoint(0,a);return Math.floor(o.pointY*this._getRetain(i)-n*256)}lnglatToPixel(a,i,n){let o=this._lngToPixelX(a,n),s=this._latToPixelY(i,n);return{pixelX:o,pixelY:s}}_pixelXToLng(a,i,n){let o=(i*256+a)/this._getRetain(n);return this.pointToLnglat(o,0).lng}_pixelYToLat(a,i,n){let o=(i*256+a)/this._getRetain(n);return this.pointToLnglat(0,o).lat}pixelToLnglat(a,i,n,o,s){let e=(n*256+a)/this._getRetain(s),h=(o*256+i)/this._getRetain(s),u=this.pointToLnglat(e,h);return[u.lng,u.lat]}}Object.freeze=function(t){return t};var Re=/\{ *([\w_-]+) *\}/g;function Pe(t,a){return t.replace(Re,function(i,n){let o=a[n];if(o===void 0)throw new Error(`No value provided for variable ${i}`);return typeof o=="function"&&(o=o(a)),o})}class Le{constructor(a,i){if(this.program=null,this.showTiles=[],this.isReadRender=!1,this.isLayerShow=!1,this.tileCache=[],this.gridCache={},this.transformBaidu=new Ae,this.maskCache=[],this._projectionMatrix=new ot,this._viewMatrix4=new ot,this._mvpMatrix4=new ot,this.isOrtho=!1,!a)throw new Error("");this.validate(i),this.map=a,this.center=a.getCenter().toArray(),this.options=Object.assign(this.getDefaultGlLayerOptions(),i),this.customCoords=a.customCoords,this.customCoords.lngLatsToCoords([this.center]),this.layer=new AMap.GLCustomLayer({zooms:this.options.zooms,opacity:this.options.opacity,visible:this.options.visible,zIndex:this.options.zIndex,init:n=>{this.gl=n;const o=`
                    uniform mat4 u_ProjectionMatrix;
                    uniform mat4 u_ViewMatrix4;
                    uniform mat4 u_MvpMatrix4;
                    uniform bool u_isOrtho;
                    attribute vec2 a_pos;
                    attribute vec2 a_TextCoord;
                    varying vec2 v_TextCoord;
                    void main() {
                       if(u_isOrtho){
                         gl_Position = u_MvpMatrix4 * vec4(a_pos,0.0, 1.0);
                       }else{
                         gl_Position = u_ProjectionMatrix * u_ViewMatrix4 * vec4(a_pos,0.0, 1.0);
                       }
                       v_TextCoord = a_TextCoord;
                    }`,s=`
                    precision mediump float;
                    uniform sampler2D u_Sampler;
                    uniform bool u_isFirst;
                    varying vec2 v_TextCoord;
                    void main() {
                       if(u_isFirst){
                         gl_FragColor = vec4(1.0, 0.0, 0.0, 0.0);
                       }else{
                         gl_FragColor = texture2D(u_Sampler, v_TextCoord);
                       }
                    }`,e=n.createShader(n.VERTEX_SHADER);n.shaderSource(e,o),n.compileShader(e);const h=n.createShader(n.FRAGMENT_SHADER);n.shaderSource(h,s),n.compileShader(h),this.program=n.createProgram(),n.attachShader(this.program,e),n.attachShader(this.program,h),n.linkProgram(this.program),this.a_Pos=n.getAttribLocation(this.program,"a_pos"),this.a_TextCoord=n.getAttribLocation(this.program,"a_TextCoord");const u="uniform mat4 u_ProjectionMatrix;uniform mat4 u_ViewMatrix4;uniform mat4 u_MvpMatrix4;uniform bool u_isOrtho;attribute vec2 a_pos;void main() {   if(u_isOrtho){     gl_Position = u_MvpMatrix4 * vec4(a_pos,0.0, 1.0);   }else{     gl_Position = u_ProjectionMatrix * u_ViewMatrix4 * vec4(a_pos,0.0, 1.0);   }}",c="void main() {    gl_FragColor = vec4(0.0, 1.0, 0.0, 0.0);}",l=n.createShader(n.VERTEX_SHADER);n.shaderSource(l,u),n.compileShader(l);const M=n.createShader(n.FRAGMENT_SHADER);n.shaderSource(M,c),n.compileShader(M),this.maskProgram=n.createProgram(),n.attachShader(this.maskProgram,l),n.attachShader(this.maskProgram,M),n.linkProgram(this.maskProgram),this.mask_Pos=n.getAttribLocation(this.maskProgram,"a_pos"),this.options.visible&&(this.isLayerShow=!0),this.mapCallback=()=>{this.isLayerShow&&this.update()},a.on("dragging",this.mapCallback),a.on("moveend",this.mapCallback),a.on("zoomchange",this.mapCallback),a.on("rotatechange",this.mapCallback),this._createMask(this.options.mask),this.update()},render:n=>{if(!this.isReadRender)return;const o=this.options.zooms;if(!(this.map.getZoom()<o[0]||this.map.getZoom()>o[1])){if(this.customCoords.setCenter(this.center),a.getView().type==="3D"){this.isOrtho=!1;const{near:s,far:e,fov:h,up:u,lookAt:c,position:l}=this.customCoords.getCameraParams();this._viewMatrix4.lookAt({eye:l,center:c,up:u}).translate([0,0,this.options.altitude]),this._projectionMatrix.perspective({fovy:h*Math.PI/180,far:e,near:s,aspect:n.drawingBufferWidth/n.drawingBufferHeight})}else{this.isOrtho=!0;const s=this.customCoords.getMVPMatrix();this._mvpMatrix4.copy(s)}this.maskCache.length>0?(n.clearStencil(0),n.clear(n.STENCIL_BUFFER_BIT),n.enable(n.STENCIL_TEST),n.stencilFunc(n.ALWAYS,1,255),n.stencilOp(n.KEEP,n.KEEP,n.REPLACE),this._renderMask(n),n.stencilFunc(n.EQUAL,1,255),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.disable(n.DEPTH_TEST),this._renderTile(n),n.enable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST)):this._renderTile(n)}}}),a.add(this.layer)}_renderMask(a){if(this.maskCache.length){this.customCoords.setCenter(this.center),a.useProgram(this.maskProgram),this.setVertex(a,this.maskProgram);for(const i of this.maskCache)a.bindBuffer(a.ARRAY_BUFFER,i.vertexBuffer),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,i.indexBuffer),a.vertexAttribPointer(this.mask_Pos,2,a.FLOAT,!1,0,0),a.enableVertexAttribArray(this.mask_Pos),a.drawElements(a.TRIANGLES,i.deviationLength,a.UNSIGNED_INT,0)}}_renderTile(a){var i,n,o,s,e,h;this.customCoords.setCenter(this.center),a.useProgram(this.program),this.setVertex(a,this.program);let u=0;for(const c of this.showTiles){if(!c.isLoad||c.imageError)continue;a.bindTexture(a.TEXTURE_2D,c.texture),a.activeTexture(a.TEXTURE0),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.MIRRORED_REPEAT);const l=a.getUniformLocation(this.program,"u_Sampler");a.uniform1i(l,0),a.uniform1f(a.getUniformLocation(this.program,"u_isFirst"),u===0),a.bindBuffer(a.ARRAY_BUFFER,c.buffer),a.vertexAttribPointer(this.a_Pos,(i=c.PosParam)===null||i===void 0?void 0:i.size,a.FLOAT,!1,(n=c.PosParam)===null||n===void 0?void 0:n.stride,(o=c.PosParam)===null||o===void 0?void 0:o.offset),a.vertexAttribPointer(this.a_TextCoord,(s=c.TextCoordParam)===null||s===void 0?void 0:s.size,a.FLOAT,!1,(e=c.TextCoordParam)===null||e===void 0?void 0:e.stride,(h=c.TextCoordParam)===null||h===void 0?void 0:h.offset),a.enableVertexAttribArray(this.a_Pos),a.enableVertexAttribArray(this.a_TextCoord),a.enable(a.BLEND),a.blendFunc(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA),a.drawArrays(a.TRIANGLE_STRIP,0,4),u++}}validate(a){if(!a.url)throw new Error("url");if(a.url.includes("{s}")&&(!a.subdomains||a.subdomains.length===0))throw new Error("subdomains")}getDefaultGlLayerOptions(){return{url:"",zooms:[2,18],opacity:1,visible:!0,zIndex:120,proj:"gcj02",tileType:"xyz",debug:!1,cacheSize:512,tileMaxZoom:18,altitude:0}}_createMask(a){if(!a||a.length===0){this.maskCache=[];return}const i=this.getMaskDeep(a);if(i<2||i>4){console.warn("mask");return}i===2?a=[[a]]:i===3&&(a=[a]);for(let n of a){n=this._convertMaskLnglatToCoords(n);const o=Et.exports.flatten(n),s=Et.exports(o.vertices,o.holes,o.dimensions),e=this.gl,h=new Float32Array(o.vertices),u=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,u),e.bufferData(e.ARRAY_BUFFER,h,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null);const c=e.createBuffer();e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,c),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint32Array(s),e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),this.maskCache.push({FSIZE:h.BYTES_PER_ELEMENT,vertexBuffer:u,indexBuffer:c,deviationLength:s.length})}}getMaskDeep(a,i=1){return a.length?typeof a[0]=="number"?i:this.getMaskDeep(a[0],i+1):-1}_convertMaskLnglatToCoords(a){return!a||a.length===0?a:typeof a[0]=="number"?this._convertLnglatToCoords([a[0],a[1]]):a.map(i=>this._convertMaskLnglatToCoords(i))}_convertLnglatToCoords(a){return this.customCoords.setCenter(this.center),this.customCoords.lngLatsToCoords([a])[0]}update(){if(!this.gl)return;this.isReadRender=!1;const a=this.gl,i=this.map,n=i.getCenter();let o=Math.ceil(i.getZoom());o>this.options.tileMaxZoom&&(o=this.options.tileMaxZoom);const s=i.getBounds();let e,h,u,c;if(this.options.tileType==="xyz"?(u=s.getNorthWest().toArray(),c=s.getSouthEast().toArray()):(u=s.getSouthWest().toArray(),c=s.getNorthEast().toArray()),this.options.proj==="wgs84"){const r=ta(...u),f=ta(...c);e=nt(r.lng,r.lat,o),h=nt(f.lng,f.lat,o)}else if(this.options.proj==="bd09"){const r=ia(...u),f=ia(...c);e=this.transformBaidu.lnglatToTile(r.lng,r.lat,o),h=this.transformBaidu.lnglatToTile(f.lng,f.lat,o)}else e=nt(u[0],u[1],o),h=nt(c[0],c[1],o);const l=[];for(let r=e[0];r<=h[0];r++)for(let f=e[1];f<=h[1];f++){const p={x:r,y:f,z:o};l.push(p),this.addGridCache(p,0,0),r===h[0]&&this.addGridCache(p,1,0),f===h[1]&&this.addGridCache(p,0,1),r===h[0]&&f===h[1]&&this.addGridCache(p,1,1)}let M;this.options.tileType==="xyz"?M=nt(n.getLng(),n.getLat(),o):M=this.transformBaidu.lnglatToTile(n.getLng(),n.getLat(),o),l.sort((r,f)=>this.tileDistance(r,M)-this.tileDistance(f,M)),this._cancelOutViewImage(l),this._clearShowTile();for(const r of l){const f=this.createTileKey(r),p=this.getTileCache(f);if(p){if(p.imageError)continue;!p.isLoad&&p.image&&p.imageCanceled&&(p.image.src=p.url,p.imageCanceled=!1),this.showTiles.push(p)}else{const v=this.createTile(a,r);this.showTiles.push(v),this.pushTileCache(v)}}this.showTiles.length>0&&this.showTiles.unshift(this.showTiles[0]),this.isReadRender=!0}_cancelOutViewImage(a){this.tileCache.forEach(i=>{a.findIndex(n=>this.createTileKey(n)===i.xyzKey)===-1&&!i.isLoad&&i.image&&(i.image.src="",i.imageCanceled=!0)})}getTileCache(a){return this.tileCache.find(i=>i.xyzKey===a)}pushTileCache(a){const i=this.options.cacheSize;i>0&&this.tileCache.length>=i&&(this.showTiles.findIndex(n=>n.xyzKey===this.tileCache[0].xyzKey)<0&&this._destroyTile(this.tileCache[0]),this.tileCache.splice(0,1)),this.tileCache.push(a)}addGridCache(a,i,n){const o=this.createTileKey(a.x+i,a.y+n,a.z);if(!this.gridCache[o])if(this.options.proj==="wgs84"){const s=Ee(...Qt(a.x+i,a.y+n,a.z)),e=this._convertLnglatToCoords([s.lng,s.lat]);this.gridCache[o]={lng:e[0],lat:e[1]}}else if(this.options.tileType==="bd09"){const s=Oe(...this.transformBaidu.pixelToLnglat(0,0,a.x+i,a.y+n,a.z)),e=this._convertLnglatToCoords([s.lng,s.lat]);this.gridCache[o]={lng:e[0],lat:e[1]}}else{const s=this._convertLnglatToCoords(Qt(a.x+i,a.y+n,a.z));this.gridCache[o]={lng:s[0],lat:s[1]}}}tileDistance(a,i){return Math.sqrt(Math.pow(a.x-i[0],2)+Math.pow(a.y-i[1],2))}createTileKey(a,i,n){return a instanceof Object?`${a.z}/${a.x}/${a.y}`:`${n}/${a}/${i}`}deepFormatTileNumber(a,i){return a>=0&&a<i?a:(a>0&&a>=i?a=a-i:a<0&&(a=a+i),this.deepFormatTileNumber(a,i))}createTile(a,i){let n=Math.ceil(this.map.getZoom());n>this.options.tileMaxZoom&&(n=this.options.tileMaxZoom);const o=Math.pow(2,n);let s=i.x,e=i.y;s=this.deepFormatTileNumber(s,o),e=this.deepFormatTileNumber(e,o);const h={x:s,y:e,z:i.z};this.options.subdomains&&(h.s=this.options.subdomains[Math.abs(i.x+i.y)%this.options.subdomains.length]);const u=Pe(this.options.url,h),c={xyz:i,xyzKey:this.createTileKey(i),isLoad:!1,url:u,imageCanceled:!1};let l,M,r,f;this.options.tileType==="xyz"?(l=this.gridCache[this.createTileKey(i)],M=this.gridCache[this.createTileKey(i.x+1,i.y,i.z)],r=this.gridCache[this.createTileKey(i.x,i.y+1,i.z)],f=this.gridCache[this.createTileKey(i.x+1,i.y+1,i.z)]):(l=this.gridCache[this.createTileKey(i.x,i.y+1,i.z)],M=this.gridCache[this.createTileKey(i.x+1,i.y+1,i.z)],r=this.gridCache[this.createTileKey(i)],f=this.gridCache[this.createTileKey(i.x+1,i.y,i.z)]);const p=new Float32Array([l.lng,l.lat,0,1,r.lng,r.lat,0,0,M.lng,M.lat,1,1,f.lng,f.lat,1,0]),v=p.BYTES_PER_ELEMENT,m=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,m),a.bufferData(a.ARRAY_BUFFER,p,a.STATIC_DRAW),c.buffer=m,c.PosParam={size:2,stride:v*4,offset:0},c.TextCoordParam={size:2,stride:v*4,offset:v*2};const d=new Image(256,256);return d.onload=()=>{if(c.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,c.texture),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,1),this.options.debug){const O=document.createElement("canvas");O.width=256,O.height=256;const y=O.getContext("2d");y.drawImage(d,0,0),y.font="25px Verdana",y.fillStyle="#ff0000",y.strokeStyle="#FF0000",y.strokeRect(0,0,256,256),y.fillText(`(${[i.x,i.y,i.z].join(",")})`,10,30),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,O)}else a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,d);c.isLoad=!0,this.showTiles.findIndex(O=>O===c)>=0&&this.map.render()},d.onerror=()=>{c.imageCanceled||(c.imageError=!0)},d.crossOrigin="anonymous",d.src=u,c.image=d,c}setVertex(a,i){a.uniformMatrix4fv(a.getUniformLocation(i,"u_ProjectionMatrix"),!1,this._projectionMatrix.toArray()),a.uniformMatrix4fv(a.getUniformLocation(i,"u_ViewMatrix4"),!1,this._viewMatrix4.toArray()),a.uniformMatrix4fv(a.getUniformLocation(i,"u_MvpMatrix4"),!1,this._mvpMatrix4.toArray()),a.uniform1f(a.getUniformLocation(i,"u_isOrtho"),this.isOrtho)}show(){this.isLayerShow=!0,this.update(),this.layer.show()}hide(){this.isLayerShow=!1,this.layer.hide()}getzIndex(){return this.layer.getzIndex()}setzIndex(a){this.options.zIndex=a,this.layer.setzIndex(a)}getOpacity(){return this.layer.getOpacity()}setOpacity(a){this.options.opacity=a,this.layer.setOpacity(a)}getZooms(){return this.layer.getZooms()}setZooms(a){this.options.zooms=a,this.layer.setZooms(a)}setMask(a){this._destroyMaskCache(),this._createMask(a),this.options.mask=a,this.map.render()}getMask(){return this.options.mask}getMap(){return this.map}_destroyMaskCache(){this.maskCache.forEach(a=>{this.gl.deleteBuffer(a.vertexBuffer),this.gl.deleteBuffer(a.indexBuffer)}),this.maskCache=[]}_destroyTile(a){a.buffer&&this.gl.deleteBuffer(a.buffer),a.texture&&this.gl.deleteTexture(a.texture)}_clearAllCacheTile(){this.tileCache.forEach(a=>{this._destroyTile(a)}),this.tileCache=[]}_clearShowTile(){this.showTiles.forEach(a=>{this.tileCache.findIndex(i=>i.xyzKey===a.xyzKey)<0&&this._destroyTile(a)}),this.showTiles=[]}destroy(){this.isLayerShow=!1,this.map.remove(this.layer),this.map.off("dragging",this.mapCallback),this.map.off("moveend",this.mapCallback),this.map.off("zoomchange",this.mapCallback),this.map.off("rotatechange",this.mapCallback),this._destroyMaskCache(),this._clearShowTile(),this._clearAllCacheTile(),this.gridCache={},this.transformBaidu=null,this.mapCallback=null,this.gl.deleteProgram(this.program),this.gl.deleteProgram(this.maskProgram),this.program=null,this.maskProgram=null,this.options=void 0,this.customCoords=void 0,this.center=void 0,this.layer=null,this.gl=null,this.map=null}}const Se=pi({url:{required:!0,type:String},subdomains:{type:Array},tileType:{type:String,default:"xyz",validator:t=>["xyz","bd09"].indexOf(t)!==-1},proj:{type:String,default:"gcj02",validator:t=>["wgs84","gcj02","bd09"].indexOf(t)!==-1},zooms:{type:Object},opacity:{type:Number},zIndex:{type:Number,default:120},mask:{type:Array},cacheSize:{type:Number,default:512},debug:{type:Boolean,default:!1},tileMaxZoom:{type:Number},altitude:{type:Number}}),Ce=ea({name:"ElAmapLayerCustomXyz",inheritAttrs:!1,__name:"CustomXyz",props:Se,emits:["init"],setup(t,{expose:a,emit:i}){const n=i;let o;const{$$getInstance:s}=mi((h,u)=>new Promise(c=>{o=new Le(u,h),c(o)}),{emits:n,destroyComponent(){o&&(o.destroy(),o=null)}});a({$$getInstance:s});const e={emits:n,get $amapComponent(){return o},set $amapComponent(h){o=h},$$getInstance:s};return Object.defineProperty(e,"__isScriptSetup",{enumerable:!1,value:!0}),e}});function we(t,a,i,n,o,s){return Yt(),ua("div")}const bt=ha(Ce,[["render",we],["__file","CustomXyz.vue"]]);bt.install=t=>(t.component(bt.name,bt),t);const Ne=bt,ke=ea({__name:"custom-xyz",setup(t,{expose:a}){a();const i=it([116.335036,39.900082]),n=it(8),o=it(!0),s=it(["1","2","3","4"]);let e,h;const u=it(1e4),r={center:i,zoom:n,visible:o,subdomains:s,get mask(){return e},set mask(f){e=f},get polygonData(){return h},set polygonData(f){h=f},altitude:u,style:{height:1e4,topColor(f,p){return"rgba(255,255,255,0)"},sideTopColor(f,p){return"rgba(0,255,255,0.4)"},sideBottomColor(f,p){return"#00C6DA"}},switchVisible:()=>{o.value=!o.value},initMap:f=>{console.log("map: ",f);const p={subdistrict:0,extensions:"all",level:"city"},v=new AMap.DistrictSearch(p),m=[];v.search("",(d,O)=>{const y=O.districtList[0].boundaries;for(let g=0;g<y.length;g+=1)m.push([y[g].map(T=>T.toArray())]);console.log("maskArea: ",m),e=m,h={type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"MultiPolygon",coordinates:JSON.parse(JSON.stringify(m))}}]}})},get ElAmap(){return vi},get ElAmapLayerCustomXyz(){return Ne},get ElAmapLoca(){return bi},get ElAmapLocaAmbientLight(){return Ei},get ElAmapLocaPolygon(){return Oi}};return Object.defineProperty(r,"__isScriptSetup",{enumerable:!1,value:!0}),r}}),Ie={class:"map-page-container"},Ye={class:"toolbar"};function De(t,a,i,n,o,s){return Yt(),ua(xi,null,[St("div",Ie,[ut(n.ElAmap,{"show-label":!1,center:n.center,zoom:n.zoom,pitch:60,"view-mode":"3D",mask:n.mask,onInit:n.initMap},{default:Vt(()=>[ut(n.ElAmapLayerCustomXyz,{url:"http://webst0{s}.is.autonavi.com/appmaptile?style=6&x={x}&y={y}&z={z}",subdomains:n.subdomains,mask:n.mask,altitude:n.altitude,visible:n.visible},null,8,["subdomains","mask","altitude","visible"]),ut(n.ElAmapLoca,null,{default:Vt(()=>[ut(n.ElAmapLocaAmbientLight,{color:"#fff",intensity:.6}),n.polygonData?(Yt(),yi(n.ElAmapLocaPolygon,{key:0,"source-data":n.polygonData,"block-hide":!1,depth:!1,"has-side":!0,"layer-style":n.style},null,8,["source-data"])):di("",!0)]),_:1})]),_:1},8,["center","zoom","mask"])]),St("div",Ye,[St("button",{onClick:a[0]||(a[0]=e=>n.switchVisible())},gi(n.visible?"":""),1)])],64)}const Be=ha(ke,[["render",De],["__file","custom-xyz.vue"]]);export{Be as default};
