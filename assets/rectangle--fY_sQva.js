import{u as F}from"./useEditor-CRncnCXg.js";import{b as N,u as z,i as O,a as B,d as C,E as V}from"./index-XVBT3eyP.js";import{p as M,aq as $,_ as S,o as R,c as x,f as d,a as m,d as A,w as j,ao as v,al as L}from"./app-BIv4BGsj.js";function E(s){return new AMap.LngLat(s[0],s[1])}const P=N({bounds:{type:Array,required:!0},bubble:{type:Boolean,default:!1},cursor:{type:String},strokeColor:{type:String},strokeOpacity:{type:Number},strokeWeight:{type:Number},fillColor:{type:String},fillOpacity:{type:Number},draggable:{type:Boolean,default:!1},extData:{type:Object,default:()=>null},strokeStyle:{type:String,validator:s=>["solid","dashed"].indexOf(s)!==-1},strokeDasharray:{type:Array},editable:{type:Boolean,default:!1},editOptions:{type:Object}}),W=M({name:"ElAmapRectangle",inheritAttrs:!1,__name:"Rectangle",props:P,emits:["init","update:bounds"],setup(s,{expose:u,emit:p}){const o=s,r=p;let t;const{$$getInstance:c,parentInstance:a}=z((e,l)=>new Promise(h=>{t=new AMap.Rectangle(e),O(l)?l.add(t):B(l)?l.addOverlay(t):C(l)&&l.add(t),f(),h(t)}),{emits:r,converts:{bounds:e=>new AMap.Bounds(E(e[0]),E(e[1]))},watchRedirectFn:{__zIndex(e){t&&t.setOptions({zIndex:e})},__strokeColor(e){t&&t.setOptions({strokeColor:e})},__strokeOpacity(e){t&&t.setOptions({strokeOpacity:e})},__strokeWeight(e){t&&t.setOptions({strokeWeight:e})},__fillColor(e){t&&t.setOptions({fillColor:e})},__fillOpacity(e){t&&t.setOptions({fillOpacity:e})},__strokeStyle(e){t&&t.setOptions({strokeStyle:e})},__strokeDasharray(e){t&&t.setOptions({strokeDasharray:e})},__editable(e){y().then(()=>{e?n.open():n.close()})}},destroyComponent(){t&&(a!=null&&a.$amapComponent)&&(n&&(a.isDestroy||n.close(),n=null),a.isDestroy||(O(a.$amapComponent)?a.$amapComponent.remove(t):B(a.$amapComponent)?a.$amapComponent.removeOverlay(t):C(a.$amapComponent)&&a.$amapComponent.remove(t)),t.destroy&&t.destroy(),t=null)}}),f=()=>{t.on("dragend",()=>{i(t)}),t.on("touchend",()=>{i(t)})},i=e=>{const l=e.getBounds(),h=l.getSouthWest(),w=l.getNorthEast(),D=[h.toArray(),w.toArray()];r("update:bounds",D)};let n;const b=$(),y=()=>new Promise(e=>{n?e():AMap.plugin(["AMap.RectangleEditor"],()=>{n=new AMap.RectangleEditor(a==null?void 0:a.$amapComponent,t,o.editOptions),F(n,b),k(),e()})}),k=()=>{n.on("addnode",e=>{i(e.target)}),n.on("adjust",e=>{i(e.target)}),n.on("removenode",e=>{i(e.target)}),n.on("add",e=>{i(e.target)}),n.on("end",e=>{i(e.target)})};u({$$getInstance:c});const g={props:o,emits:r,get $amapComponent(){return t},set $amapComponent(e){t=e},$$getInstance:c,parentInstance:a,bindModelEvents:f,emitModel:i,get editor(){return n},set editor(e){n=e},attrs:b,createEditor:y,bindEditorModelEvents:k};return Object.defineProperty(g,"__isScriptSetup",{enumerable:!1,value:!0}),g}});function I(s,u,p,o,r,t){return R(),x("div")}const _=S(W,[["render",I],["__file","Rectangle.vue"]]);_.install=s=>(s.component(_.name,_),s);const q=_,G=M({__name:"rectangle",setup(s,{expose:u}){u();const p=d(15),o=d([121.5273285,31.21515044]),r=d(!1),t=d(!0),c=d(!0),a=d([[121.5273285,31.21515044],[121.5293285,31.21515044]]),g={zoom:p,center:o,draggable:r,visible:t,edit:c,path:a,clickMap:e=>{console.log("click map: ",e)},initMap:e=>{console.log("init map: ",e)},toggleVisible:()=>{t.value=!t.value},changeEditable:()=>{c.value=!c.value},changeDraggable:()=>{r.value=!r.value},click:e=>{alert("click GeoJSON")},get ElAmap(){return V},get ElAmapRectangle(){return q}};return Object.defineProperty(g,"__isScriptSetup",{enumerable:!1,value:!0}),g}}),J={class:"map-page-container"},T={class:"toolbar"};function H(s,u,p,o,r,t){return R(),x(L,null,[m("div",J,[A(o.ElAmap,{"show-label":!1,center:o.center,zoom:o.zoom,onClick:o.clickMap,onInit:o.initMap},{default:j(()=>[A(o.ElAmapRectangle,{bounds:o.path,visible:o.visible,editable:o.edit,draggable:o.draggable,onClick:o.click},null,8,["bounds","visible","editable","draggable"])]),_:1},8,["center","zoom"])]),m("div",T,[m("button",{onClick:o.toggleVisible},v(o.visible?"隐藏标记":"显示标记"),1),m("button",{onClick:o.changeDraggable},v(o.draggable?"禁止标记移动":"允许标记移动"),1),m("button",{onClick:o.changeEditable},v(o.edit?"停止编辑":"开始编辑"),1)])],64)}const X=S(G,[["render",H],["__file","rectangle.vue"]]);export{X as default};
