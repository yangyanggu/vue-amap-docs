import{_ as t,r as p,o as e,c as o,a as n,b as s,d as c,e as l}from"./app-BIv4BGsj.js";const i={},u=n("h1",{id:"说明",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#说明"},[n("span",null,"说明")])],-1),d=n("code",null,"process",-1),r=n("code",null,"window",-1),k=n("br",null,null,-1),v={href:"https://github.com/yangyanggu/vue-amap-nuxt-demo",target:"_blank",rel:"noopener noreferrer"},m=l(`<h2 id="加载高德地图api" tabindex="-1"><a class="header-anchor" href="#加载高德地图api"><span>加载高德地图api</span></a></h2><p>高德地图api的加载时间需要更改为在vue的<code>onBeforeMount</code>生命周期中执行，示例如下：</p><h4 id="_1-创建maploadutil-js" tabindex="-1"><a class="header-anchor" href="#_1-创建maploadutil-js"><span>1. 创建<code>mapLoadUtil.js</code></span></a></h4><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>initAMapApiLoader<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vuemap/vue-amap&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">initMapApi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">initAMapApiLoader</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">&#39;XXXXX&#39;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-创建nuxt的maploaded-js插件" tabindex="-1"><a class="header-anchor" href="#_2-创建nuxt的maploaded-js插件"><span>2. 创建Nuxt的<code>mapLoaded.js</code>插件</span></a></h4><p>需要创建插件处理process对象，从<code>2.0.18</code>版本开始不再需要该处理方案</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> process<span class="token operator">!==</span> <span class="token string">&#39;undefined&#39;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    process<span class="token punctuation">.</span>env <span class="token operator">=</span> process<span class="token punctuation">.</span>env <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineNuxtPlugin</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">nuxtApp</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-加载css文件" tabindex="-1"><a class="header-anchor" href="#_3-加载css文件"><span>3. 加载CSS文件</span></a></h4><p>修改Nuxt配置<code>nuxt.config.ts</code></p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineNuxtConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">css</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;@vuemap/vue-amap/dist/style.css&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4-页面加载组件" tabindex="-1"><a class="header-anchor" href="#_4-页面加载组件"><span>4. 页面加载组件</span></a></h4><p>在<code>onBeforeMount</code>中加载JSAPI。同时组件需要放入<code>ClientOnly</code>组件中。</p><div class="language-vue line-numbers-mode" data-ext="vue" data-title="vue"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>map-container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ClientOnly</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ElAmap</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ElAmap</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ClientOnly</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span>initMapApi<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;~/util/mapLoadUtil&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>onBeforeMount<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>ElAmap<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vuemap/vue-amap&quot;</span><span class="token punctuation">;</span>

<span class="token function">onBeforeMount</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">initMapApi</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">.map-container</span><span class="token punctuation">{</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 500px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,13);function g(b,h){const a=p("ExternalLinkIcon");return e(),o("div",null,[u,n("p",null,[s("由于组件库内部使用的插件会使用部分特殊的对象，比如"),d,s("、"),r,s("。因此在使用时需要根据Nuxt要求处理加载顺序和对象的默认值处理。"),k,n("a",v,[s("Nuxt示例"),c(a)])]),m])}const _=t(i,[["render",g],["__file","ssr.html.vue"]]);export{_ as default};
