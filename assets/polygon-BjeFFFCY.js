import{u as S}from"./useEditor-CRncnCXg.js";import{b as x,u as F,i as v,a as O,d as C,j as w,E as j}from"./index-XVBT3eyP.js";import{p as A,aq as z,_ as P,o as M,c as D,f as B,ag as N,a as p,d as E,w as V,ao as k,al as I}from"./app-BIv4BGsj.js";const W=x({path:{type:Array,required:!0},bubble:{type:Boolean,default:!1},cursor:{type:String},strokeColor:{type:String},strokeOpacity:{type:Number},strokeWeight:{type:Number},fillColor:{type:String},fillOpacity:{type:Number},draggable:{type:Boolean,default:!1},extData:{type:Object,default:()=>null},strokeStyle:{type:String,validator:l=>["solid","dashed"].indexOf(l)!==-1},strokeDasharray:{type:Array},editable:{type:Boolean,default:!1},editOptions:{type:Object}}),$=A({name:"ElAmapPolygon",inheritAttrs:!1,__name:"Polygon",props:W,emits:["init","update:path"],setup(l,{expose:c,emit:d}){const o=l,r=d;let t;const{$$getInstance:m,parentInstance:a}=F((e,i)=>new Promise(h=>{t=new AMap.Polygon(e),v(i)?i.add(t):O(i)?i.addOverlay(t):C(i)&&i.add(t),y(),h(t)}),{emits:r,watchRedirectFn:{__zIndex(e){t&&t.setOptions({zIndex:e})},__strokeColor(e){t&&t.setOptions({strokeColor:e})},__strokeOpacity(e){t&&t.setOptions({strokeOpacity:e})},__strokeWeight(e){t&&t.setOptions({strokeWeight:e})},__fillColor(e){t&&t.setOptions({fillColor:e})},__fillOpacity(e){t&&t.setOptions({fillOpacity:e})},__strokeStyle(e){t&&t.setOptions({strokeStyle:e})},__strokeDasharray(e){t&&t.setOptions({strokeDasharray:e})},__editable(e){f().then(()=>{e?n.open():n.close()})}},destroyComponent(){t&&(a!=null&&a.$amapComponent)&&(n&&(a.isDestroy||n.close(),n=null),a.isDestroy||(v(a.$amapComponent)?a.$amapComponent.remove(t):O(a.$amapComponent)?a.$amapComponent.removeOverlay(t):C(a.$amapComponent)&&a.$amapComponent.remove(t)),t.destroy&&t.destroy(),t=null)}}),y=()=>{t.on("dragend",()=>{s(t)}),t.on("touchend",()=>{s(t)})},s=e=>{const i=e.getPath(),h=i==null?void 0:i.map(w);r("update:path",h)};let n;const _=z(),f=()=>new Promise(e=>{n?e():AMap.plugin(["AMap.PolygonEditor"],()=>{n=new AMap.PolygonEditor(a==null?void 0:a.$amapComponent,t,o.editOptions),S(n,_),b(),e()})}),b=()=>{n.on("addnode",e=>{s(e.target)}),n.on("adjust",e=>{s(e.target)}),n.on("removenode",e=>{s(e.target)}),n.on("add",e=>{s(e.target)}),n.on("end",e=>{s(e.target)})};c({$$getInstance:m});const g={props:o,emits:r,get $amapComponent(){return t},set $amapComponent(e){t=e},$$getInstance:m,parentInstance:a,bindModelEvents:y,emitModel:s,get editor(){return n},set editor(e){n=e},attrs:_,createEditor:f,bindEditorModelEvents:b};return Object.defineProperty(g,"__isScriptSetup",{enumerable:!1,value:!0}),g}});function q(l,c,d,o,r,t){return M(),D("div")}const u=P($,[["render",q],["__file","Polygon.vue"]]);u.install=l=>(l.component(u.name,u),l);const G=u,L=A({__name:"polygon",setup(l,{expose:c}){c();const d=B(15),o=B([121.5273285,31.21515044]),r=N({draggable:!1,visible:!0,edit:!0,path:[[121.5273285,31.21515044],[121.5293285,31.21515044],[121.5293285,31.21915044],[121.5273285,31.21515044]]}),g={zoom:d,center:o,polygon:r,clickMap:e=>{console.log("click map: ",e)},initMap:e=>{console.log("init map: ",e)},toggleVisible:()=>{r.visible=!r.visible},changeEditable:()=>{r.edit=!r.edit},changeDraggable:()=>{r.draggable=!r.draggable},click:e=>{alert("click GeoJSON")},dragstart:()=>{console.log("开始移动")},dragging:()=>{console.log("正在移动...")},dragend:()=>{console.log("结束移动")},get ElAmap(){return j},get ElAmapPolygon(){return G}};return Object.defineProperty(g,"__isScriptSetup",{enumerable:!1,value:!0}),g}}),R={class:"map-page-container"},J={class:"toolbar"};function T(l,c,d,o,r,t){return M(),D(I,null,[p("div",R,[E(o.ElAmap,{"show-label":!1,center:o.center,zoom:o.zoom,onClick:o.clickMap,onInit:o.initMap},{default:V(()=>[E(o.ElAmapPolygon,{path:o.polygon.path,visible:o.polygon.visible,editable:o.polygon.edit,draggable:o.polygon.draggable,onClick:o.click,onDragstart:o.dragstart,onDragging:o.dragging,onDragend:o.dragend},null,8,["path","visible","editable","draggable"])]),_:1},8,["center","zoom"])]),p("div",J,[p("button",{onClick:o.toggleVisible},k(o.polygon.visible?"隐藏标记":"显示标记"),1),p("button",{onClick:o.changeDraggable},k(o.polygon.draggable?"禁止标记移动":"允许标记移动"),1),p("button",{onClick:o.changeEditable},k(o.polygon.edit?"停止编辑":"开始编辑"),1)])],64)}const U=P(L,[["render",T],["__file","polygon.vue"]]);export{U as default};
